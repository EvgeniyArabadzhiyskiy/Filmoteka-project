!function(){function t(t){return t&&t.__esModule?t.default:t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=e.parcelRequire37c5;null==i&&((i=function(t){if(t in n)return n[t].exports;if(t in r){var e=r[t];delete r[t];var i={id:t,exports:{}};return n[t]=i,e.call(i.exports,i,i.exports),i.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){r[t]=e},e.parcelRequire37c5=i),i("iE7OH").register(JSON.parse('{"EVgbq":"index.64c3ab6f.js","jEEqz":"no-poster.325dd571.jpg","5UbS1":"index.d51a5706.css","5yY5W":"index.b2a78024.js"}'));var a=i("bpxeT"),o=i("2TvXO");i("hSdu6"),i("17a3X");var s,u=i("dh4R1");s=i("aNJCr").getBundleURL("EVgbq")+i("iE7OH").resolve("jEEqz");function c(e,n){var r=null==n?void 0:n.genres;return e.map((function(e){var n=e.poster_path,i=e.original_title,a=e.release_date,o=e.genre_ids,u=e.id;""===i&&(i="Sorry, no title for the movie."),a||(a="Expected");var c=o.reduce((function(t,e,n){if(!o.length)return t;if(n<=1){var i=null==r?void 0:r.find((function(t){return t.id===e}));return n<=o.length-2?t+(null==i?void 0:i.name)+", ":t+(null==i?void 0:i.name)+" "}return 2===n?t+"Others":t}),""),l=r?c:"Other",h=null==a?void 0:a.split("-").slice(0,1);return{id:u,imagePoster:n?"".concat("https://image.tmdb.org/t/p/w500").concat(n):t(s),original_title:i,releaseYear:h,fullGenresNames:l}}))}u=i("dh4R1"),u=i("dh4R1");var l=i("9DJey");function h(t){return t.map((function(t){var e=t.id,n=t.imagePoster,r=t.original_title,i=t.releaseYear,a=t.fullGenresNames;return'<li  class="movie-card-item">\n    \t\t\t\t<div class="movie-poster__container">\n    \t\t\t\t\t<img src="'.concat(n,'" alt="poster" class="imagePoster" data-id="').concat(e,'"/>\n\t\t\t\t\t\t<div class="btn-box gallery">\n\t\t\t\t\t\t\t<button class="btn-watche gallery-btn" data-id="').concat(e,'" data-target="watched">add to <br class="transfer" />Watched</button>\n\t\t\t\t\t\t\t<button class="btn-queue gallery-btn" data-id="').concat(e,'" data-target="queue">add to queue</button>\n\t\t\t\t  \t\t</div> \n    \t\t\t\t</div>\n    \t\t\t\t<div class="movie-card-item__info">\n    \t\t\t\t\t<h2 class="movie-card-item__title" data-id="').concat(e,'">').concat(r,'</h2>\n    \t\t\t\t\t<p class="movie-card-item__text">').concat(a," | ").concat(i," </p>\n    \t\t\t\t</div>\n\t\t\t\t\t\t\n    \t\t\t</li>")})).join("")}var f,d=document.querySelector(".movie-card-list"),v=document.querySelector(".pagination"),p=document.querySelector(".movie-card-list"),y=0;function g(t,e){var n="",r=e-2,i=e-1,a=e+1,o=e+2;y=e,t<=1||(e>1&&(n+='<li class="pagination-item pagination-arrow">&laquo</li>'),e>3&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(n+='<li class="pagination-item pagination-pages">1</li>')),e>2&&(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&e>4&&(n+='<li class="pagination-item">...</li>'),r>0&&(n+='<li class="pagination-item pagination-pages">'.concat(r,"</li>"))),i>0&&(n+='<li class="pagination-item pagination-pages">'.concat(i,"</li>")),n+='<li class="pagination-item pagination-pages current-page">'.concat(e,"</li>"),e<t&&(n+='<li class="pagination-item pagination-pages">'.concat(a,"</li>")),e<t-1&&(e<t-2&&(n+='<li class="pagination-item pagination-pages">'.concat(o,"</li>"),!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&e<t-3&&(n+='<li class="pagination-item">...</li>')),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(n+='<li class="pagination-item pagination-pages">'.concat(t,"</li>"))),e<t&&(n+='<li class="pagination-item pagination-arrow">&raquo</li>'),v.innerHTML=n,v.addEventListener("click",m))}function m(e){if("LI"===e.target.nodeName){var n=e.target.textContent;switch(n){case"«":y-=1;break;case"»":y+=1;break;case"...":return;default:y=n}p.innerHTML="",t(l).start(),u.default.fetchGenresList().then((function(t){f=t})),u.input.value?u.default.movieSearch(y).then((function(e){t(l).done();var n=h(c(e.results,f));d.insertAdjacentHTML("beforeend",n),g(e.total_pages,e.page)})).catch((function(t){return console.log(t)})):(u.default.fetchTrendData(y).then((function(t){var e=h(c(t.results,f));d.insertAdjacentHTML("beforeend",e),g(t.total_pages,t.page)})).catch((function(t){return console.log(t)})),t(l).done())}}i("kaULx");var k,w=i("1vR0Z"),b=(u=i("dh4R1"),l=i("9DJey"),u=i("dh4R1"),document.querySelector(".movie-card-list")),E=document.querySelector(".form__search"),T=document.querySelector(".movie-card-list"),S=document.querySelector(".search__error");u.default.fetchGenresList().then((function(t){k=t})),null==E||E.addEventListener("submit",(function(e){if(e.preventDefault(),!u.input.value)return S.textContent="Search field is empty. Enter movie name and press the search button",void(S.style.display="block");t(l).start(),u.default.movieSearch().then((function(t){if(0===t.total_results)S.textContent="Search result is unsuccessful. Enter the correct movie name and press the search button",S.style.display="block";else{S.style.display="none",T.innerHTML="",v.innerHTML="";var e=h(c(t.results,k));b.insertAdjacentHTML("beforeend",e),g(t.total_pages,t.page)}})).catch((function(t){return console.log(t)})),t(l).done()}));l=i("9DJey");i("ghnK3");var x=i("e1ad9"),A=(w=i("1vR0Z"),document.querySelector(".mySwiper"));(0,w.default)(A);new(0,x.default)(".mySwiper",{modules:[x.Navigation,x.Autoplay],spaceBetween:5,breakpointsBase:"container",autoplay:{delay:2e3,disableOnInteraction:!1},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{210:{slidesPerView:2},600:{slidesPerView:6},768:{slidesPerView:8}}});var I=document.querySelector(".swiper-wrapper");var C,N,D={};function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}C="undefined"!=typeof self?self:void 0,N=function(t){t.addBackToTop=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.backgroundColor,n=void 0===e?"#000":e,r=t.cornerOffset,i=void 0===r?20:r,a=t.diameter,o=void 0===a?56:a,s=t.ease,u=void 0===s?B:s,c=t.id,l=void 0===c?"back-to-top":c,h=t.innerHTML,f=void 0===h?'<svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg>':h,d=t.onClickScrollTo,v=void 0===d?0:d,p=t.scrollContainer,y=void 0===p?document.body:p,g=t.scrollDuration,m=void 0===g?100:g,k=t.showWhenScrollTopIs,w=void 0===k?1:k,b=t.size,E=void 0===b?o:b,T=t.textColor,S=void 0===T?"#fff":T,x=t.zIndex,A=void 0===x?1:x,I=y===document.body,C=I&&document.documentElement;P();var N=M(),D=!0,_=I?window:y;function L(){F()>=w?R():O()}function R(){D&&(N.className="",D=!1)}function O(){D||(N.className="hidden",D=!0)}function M(){var t=document.createElement("div");return t.id=l,t.className="hidden",t.innerHTML=f,t.addEventListener("click",(function(t){t.preventDefault(),V()})),document.body.appendChild(t),t}function P(){var t=Math.round(.43*E),e=Math.round(.29*E),r="#"+l+"{background:"+n+";-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;bottom:"+i+"px;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);color:"+S+";cursor:pointer;display:block;height:"+E+"px;opacity:1;outline:0;position:fixed;right:"+i+"px;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transition:bottom .2s,opacity .2s;-o-transition:bottom .2s,opacity .2s;-moz-transition:bottom .2s,opacity .2s;transition:bottom .2s,opacity .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:"+E+"px;z-index:"+A+"}#"+l+" svg{display:block;fill:currentColor;height:"+t+"px;margin:"+e+"px auto 0;width:"+t+"px}#"+l+".hidden{bottom:-"+E+"px;opacity:0}",a=document.createElement("style");a.appendChild(document.createTextNode(r)),document.head.insertAdjacentElement("afterbegin",a)}function V(){var t="function"==typeof v?v():v,e=window,n=e.performance,r=e.requestAnimationFrame;if(m<=0||void 0===n||void 0===r)return U(t);var i=n.now(),a=F(),o=a-t;r((function t(e){var n=Math.min((e-i)/m,1);U(a-Math.round(u(n)*o)),n<1&&r(t)}))}function F(){return y.scrollTop||C&&document.documentElement.scrollTop||0}function U(t){y.scrollTop=t,C&&(document.documentElement.scrollTop=t)}function B(t){return.5*(1-Math.cos(Math.PI*t))}_.addEventListener("scroll",L),L()}},"function"==typeof define&&define.amd?define(["exports"],N):"object"===_(D)&&"string"!=typeof D.nodeName?N(D):N(C.commonJsStrict={}),(0,D.addBackToTop)({diameter:40,backgroundColor:"#f7f7f7",textColor:"#FF6B01"});i("bpxeT"),i("2TvXO");i("2OneK");var L,R=i("3SEMc"),O=(a=i("bpxeT"),i("8MBJY")),M=i("ge8co"),P=i("a2hTj"),V=i("jh8P3"),F=i("fVNic"),U=i("eYQtU"),B=i("jmhxu"),j=i("1t1Wn"),q=i("8nrFW"),G=i("l5bVx"),K=i("2MbLg"),H=(o=i("2TvXO"),i("MjY8E")),z=i("6ExWU"),Q=i("kZfxc"),X=i("2xDiJ"),W=(O=i("8MBJY"),P=i("a2hTj"),V=i("jh8P3"),F=i("fVNic"),U=i("eYQtU"),G=i("l5bVx"),K=i("2MbLg"),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{}),Y={},J=J||{},Z=W||self;function $(){}function tt(e){var n=void 0===e?"undefined":t(G)(e);return"array"==(n="object"!=n?n:e?Array.isArray(e)?"array":n:"null")||"object"==n&&"number"==typeof e.length}function et(e){var n=void 0===e?"undefined":t(G)(e);return"object"==n&&null!=e||"function"==n}var nt="closure_uid_"+(1e9*Math.random()>>>0),rt=0;function it(t,e,n){return t.call.apply(t.bind,arguments)}function at(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ot(t,e,n){return(ot=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?it:at).apply(null,arguments)}function st(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ut(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return e.prototype[n].apply(t,i)}}function ct(){this.s=this.s,this.o=this.o}var lt={};ct.prototype.s=!1,ct.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,nt)&&t[nt]||(t[nt]=++rt)}(this);delete lt[t]}},ct.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ht=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ft=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,a=0;a<r;a++)a in i&&e.call(n,i[a],a,t)};function dt(t){return Array.prototype.concat.apply([],arguments)}function vt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function pt(t){return/^[\s\xa0]*$/.test(t)}var yt,gt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function mt(t,e){return-1!=t.indexOf(e)}function kt(t,e){return t<e?-1:t>e?1:0}t:{var wt=Z.navigator;if(wt){var bt=wt.userAgent;if(bt){yt=bt;break t}}yt=""}function Et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Tt(t){var e={};for(var n in t)e[n]=t[n];return e}var St="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var a=0;a<St.length;a++)n=St[a],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function At(t){return At[" "](t),t}At[" "]=$;var It,Ct,Nt=mt(yt,"Opera"),Dt=mt(yt,"Trident")||mt(yt,"MSIE"),_t=mt(yt,"Edge"),Lt=_t||Dt,Rt=mt(yt,"Gecko")&&!(mt(yt.toLowerCase(),"webkit")&&!mt(yt,"Edge"))&&!(mt(yt,"Trident")||mt(yt,"MSIE"))&&!mt(yt,"Edge"),Ot=mt(yt.toLowerCase(),"webkit")&&!mt(yt,"Edge");function Mt(){var t=Z.document;return t?t.documentMode:void 0}t:{var Pt="",Vt=(Ct=yt,Rt?/rv:([^\);]+)(\)|;)/.exec(Ct):_t?/Edge\/([\d\.]+)/.exec(Ct):Dt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ct):Ot?/WebKit\/(\S+)/.exec(Ct):Nt?/(?:Version)[ \/]?(\S+)/.exec(Ct):void 0);if(Vt&&(Pt=Vt?Vt[1]:""),Dt){var Ft=Mt();if(null!=Ft&&Ft>parseFloat(Pt)){It=String(Ft);break t}}It=Pt}var Ut,Bt={};function jt(){return function(t){var e=Bt;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=gt(String(It)).split("."),n=gt("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var a=e[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;t=kt(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||kt(0==a[2].length,0==o[2].length)||kt(a[2],o[2]),a=a[3],o=o[3]}while(0==t)}return 0<=t}))}if(Z.document&&Dt){var qt=Mt();Ut=qt||(parseInt(It,10)||void 0)}else Ut=void 0;var Gt=Ut,Kt=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Z.addEventListener("test",$,e),Z.removeEventListener("test",$,e)}catch(t){}return t}();function Ht(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function zt(t,e){if(Ht.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Rt){t:{try{At(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Qt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&zt.Z.h.call(this)}}Ht.prototype.h=function(){this.defaultPrevented=!0},ut(zt,Ht);var Qt={2:"touch",3:"pen",4:"mouse"};zt.prototype.h=function(){zt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Xt="closure_listenable_"+(1e6*Math.random()|0),Wt=0;function Yt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Wt,this.ca=this.fa=!1}function Jt(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Zt(t){this.src=t,this.g={},this.h=0}function $t(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],a=ht(i,e);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(Jt(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function te(t,e,n,r){for(var i=0;i<t.length;++i){var a=t[i];if(!a.ca&&a.listener==e&&a.capture==!!n&&a.ia==r)return i}return-1}Zt.prototype.add=function(t,e,n,r,i){var a=t.toString();(t=this.g[a])||(t=this.g[a]=[],this.h++);var o=te(t,e,r,i);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new Yt(e,this.src,a,!!r,i)).fa=n,t.push(e)),e};var ee="closure_lm_"+(1e6*Math.random()|0),ne={};function re(t,e,n,r,i){if(r&&r.once)return ae(t,e,n,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)re(t,e[a],n,r,i);return null}return n=fe(n),t&&t[Xt]?t.N(e,n,et(r)?!!r.capture:!!r,i):ie(t,e,n,!1,r,i)}function ie(t,e,n,r,i,a){if(!e)throw Error("Invalid event type");var o=et(i)?!!i.capture:!!i,s=le(t);if(s||(t[ee]=s=new Zt(t)),(n=s.add(e,n,r,o,a)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=ce;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Kt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ue(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function ae(t,e,n,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)ae(t,e[a],n,r,i);return null}return n=fe(n),t&&t[Xt]?t.O(e,n,et(r)?!!r.capture:!!r,i):ie(t,e,n,!0,r,i)}function oe(t,e,n,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)oe(t,e[a],n,r,i);else r=et(r)?!!r.capture:!!r,n=fe(n),t&&t[Xt]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=te(a=t.g[e],n,r,i))&&(Jt(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete t.g[e],t.h--)))):t&&(t=le(t))&&(e=t.g[e.toString()],t=-1,e&&(t=te(e,n,r,i)),(n=-1<t?e[t]:null)&&se(n))}function se(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Xt])$t(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ue(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=le(e))?($t(n,t),0==n.h&&(n.src=null,e[ee]=null)):Jt(t)}}}function ue(t){return t in ne?ne[t]:ne[t]="on"+t}function ce(t,e){if(t.ca)t=!0;else{e=new zt(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&se(t),t=n.call(r,e)}return t}function le(t){return(t=t[ee])instanceof Zt?t:null}var he="__closure_events_fn_"+(1e9*Math.random()>>>0);function fe(t){return"function"==typeof t?t:(t[he]||(t[he]=function(e){return t.handleEvent(e)}),t[he])}function de(){ct.call(this),this.i=new Zt(this),this.P=this,this.I=null}function ve(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Ht(e,t);else if(e instanceof Ht)e.target=e.target||t;else{var i=e;xt(e=new Ht(r,t),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=e.g=n[a];i=pe(o,r,!0,e)&&i}if(i=pe(o=e.g=t,r,!0,e)&&i,i=pe(o,r,!1,e)&&i,n)for(a=0;a<n.length;a++)i=pe(o=e.g=n[a],r,!1,e)&&i}function pe(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var o=e[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&$t(t.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}ut(de,ct),de.prototype[Xt]=!0,de.prototype.removeEventListener=function(t,e,n,r){oe(this,t,e,n,r)},de.prototype.M=function(){if(de.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Jt(n[r]);delete e.g[t],e.h--}}this.I=null},de.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},de.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var ye=Z.JSON.stringify;function ge(){var t=xe,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var me,ke=function(){"use strict";function e(){t(O)(this,e),this.h=this.g=null}return t(P)(e,[{key:"add",value:function(t,e){var n=we.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),we=new(function(){"use strict";function e(n,r){t(O)(this,e),this.i=n,this.j=r,this.h=0,this.g=null}return t(P)(e,[{key:"get",value:function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}]),e}())((function(){return new be}),(function(t){return t.reset()})),be=function(){"use strict";function e(){t(O)(this,e),this.next=this.g=this.h=null}return t(P)(e,[{key:"set",value:function(t,e){this.h=t,this.g=e,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Ee(t){Z.setTimeout((function(){throw t}),0)}function Te(t,e){me||function(){var t=Z.Promise.resolve(void 0);me=function(){t.then(Ae)}}(),Se||(me(),Se=!0),xe.add(t,e)}var Se=!1,xe=new ke;function Ae(){for(var t;t=ge();){try{t.h.call(t.g)}catch(t){Ee(t)}var e=we;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Se=!1}function Ie(t,e){de.call(this),this.h=t||1,this.g=e||Z,this.j=ot(this.kb,this),this.l=Date.now()}function Ce(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Ne(t,e,n){if("function"==typeof t)n&&(t=ot(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ot(t.handleEvent,t)}return 2147483647<Number(e)?-1:Z.setTimeout(t,e||0)}function De(t){t.g=Ne((function(){t.g=null,t.i&&(t.i=!1,De(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}ut(Ie,de),(L=Ie.prototype).da=!1,L.S=null,L.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ve(this,"tick"),this.da&&(Ce(this),this.start()))}},L.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},L.M=function(){Ie.Z.M.call(this),Ce(this),delete this.g};var _e=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this)).m=e,a.j=i,a.h=null,a.i=!1,a.g=null,a}return t(P)(r,[{key:"l",value:function(t){this.h=arguments,this.g?this.i=!0:De(this)}},{key:"M",value:function(){t(V)(t(F)(r.prototype),"M",this).call(this),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),r}(ct);function Le(t){ct.call(this),this.h=t,this.g={}}ut(Le,ct);var Re=[];function Oe(t,e,n,r){Array.isArray(n)||(n&&(Re[0]=n.toString()),n=Re);for(var i=0;i<n.length;i++){var a=re(e,n[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}}function Me(t){Et(t.g,(function(t,e){this.g.hasOwnProperty(e)&&se(t)}),t),t.g={}}function Pe(){this.g=!0}function Ve(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return ye(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Le.prototype.M=function(){Le.Z.M.call(this),Me(this)},Le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Pe.prototype.Aa=function(){this.g=!1},Pe.prototype.info=function(){};var Fe={},Ue=null;function Be(){return Ue=Ue||new de}function je(t){Ht.call(this,Fe.Ma,t)}function qe(t){var e=Be();ve(e,new je(e,t))}function Ge(t,e){Ht.call(this,Fe.STAT_EVENT,t),this.stat=e}function Ke(t){var e=Be();ve(e,new Ge(e,t))}function He(t,e){Ht.call(this,Fe.Na,t),this.size=e}function ze(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Z.setTimeout((function(){t()}),e)}Fe.Ma="serverreachability",ut(je,Ht),Fe.STAT_EVENT="statevent",ut(Ge,Ht),Fe.Na="timingevent",ut(He,Ht);var Qe={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Xe={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function We(){}function Ye(t){return t.h||(t.h=t.i())}function Je(){}We.prototype.h=null;var Ze,$e={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function tn(){Ht.call(this,"d")}function en(){Ht.call(this,"c")}function nn(){}function rn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Le(this),this.P=on,t=Lt?125:void 0,this.W=new Ie(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new an}function an(){this.i=null,this.g="",this.h=!1}ut(tn,Ht),ut(en,Ht),ut(nn,We),nn.prototype.g=function(){return new XMLHttpRequest},nn.prototype.i=function(){return{}},Ze=new nn;var on=45e3,sn={},un={};function cn(t,e,n){t.K=1,t.v=Ln(An(e)),t.s=n,t.U=!0,ln(t,null)}function ln(t,e){t.F=Date.now(),vn(t),t.A=An(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Hn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new an,t.g=zr(t.l,n?e:null,!t.s),0<t.O&&(t.L=new _e(ot(t.Ia,t,t.g),t.O)),Oe(t.V,t.g,"readystatechange",t.gb),e=t.H?Tt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),qe(1),function(t,e,n,r,i,a){t.info((function(){if(t.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function hn(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function fn(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=dn(t,n))==un){4==e&&(t.o=4,Ke(14),i=!1),Ve(t.j,t.m,null,"[Incomplete Response]");break}if(r==sn){t.o=4,Ke(15),Ve(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Ve(t.j,t.m,r,null),kn(t,r)}hn(t)&&r!=un&&r!=sn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ke(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Fr(e),e.L=!0,Ke(11))):(Ve(t.j,t.m,n,"[Invalid Chunked Response]"),mn(t),gn(t))}function dn(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?un:(n=Number(e.substring(n,r)),isNaN(n)?sn:(r+=1)+n>e.length?un:(e=e.substr(r,n),t.C=r+n,e))}function vn(t){t.Y=Date.now()+t.P,pn(t,t.P)}function pn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ze(ot(t.eb,t),e)}function yn(t){t.B&&(Z.clearTimeout(t.B),t.B=null)}function gn(t){0==t.l.G||t.I||jr(t.l,t)}function mn(t){yn(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ce(t.W),Me(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function kn(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Zn(n.i,t)))if(n.I=t.N,!t.J&&Zn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Br(n),Nr(n)}Vr(n),Ke(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=ze(ot(n.ab,n),6e3));if(1>=Jn(n.i)&&n.ka){try{n.ka()}catch(a){}n.ka=void 0}}else Gr(n,11)}else if((t.J||n.g==t)&&Br(n),!pt(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var a=i[e];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(mt(l,"spdy")||mt(l,"quic")||mt(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&($n(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,_n(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=Hr(r,r.H?r.la:null,r.W),d.J){tr(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(yn(v),vn(v)),r.g=d}else Pr(r);0<n.l.length&&Lr(n)}else"stop"!=a[0]&&"close"!=a[0]||Gr(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?Gr(n,7):Cr(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}qe(4)}catch(a){}}function wn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(tt(t)||"string"==typeof t)ft(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(tt(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(tt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var a=0;a<i;a++)e.call(void 0,r[a],n&&n[a],t)}}function bn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof bn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function En(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Tn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Tn(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(L=rn.prototype).setTimeout=function(t){this.P=t},L.gb=function(t){t=t.target;var e=this.L;e&&3==Tr(t)?e.l():this.Ia(t)},L.Ia=function(t){try{if(t==this.g)t:{var e=Tr(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||Lt||this.g&&(this.h.h||this.g.ga()||Sr(this.g)))){this.I||4!=e||7==n||qe(8==n||0>=r?3:2),yn(this);var i=this.g.ba();this.N=i;e:if(hn(this)){var a=Sr(this.g);t="";var o=a.length,s=4==Tr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){mn(this),gn(this);var u="";break e}this.h.i=new Z.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,a,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!pt(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,Ke(12),mn(this),gn(this);break t}Ve(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,kn(this,i)}this.U?(fn(this,e,u),Lt&&this.i&&3==e&&(Oe(this.V,this.W,"tick",this.fb),this.W.start())):(Ve(this.j,this.m,u,null),kn(this,u)),4==e&&mn(this),this.i&&!this.I&&(4==e?jr(this.l,this):(this.i=!1,vn(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Ke(12)):(this.o=0,Ke(13)),mn(this),gn(this)}}}catch(e){}},L.fb=function(){if(this.g){var t=Tr(this.g),e=this.g.ga();this.C<e.length&&(yn(this),fn(this,t,e),this.i&&4!=t&&vn(this))}},L.cancel=function(){this.I=!0,mn(this)},L.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(qe(3),Ke(17)),mn(this),this.o=2,gn(this)):pn(this,this.Y-t)},(L=bn.prototype).R=function(){En(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},L.T=function(){return En(this),this.g.concat()},L.get=function(t,e){return Tn(this.h,t)?this.h[t]:e},L.set=function(t,e){Tn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},L.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);t.call(e,a,i,this)}};var Sn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof xn){this.g=void 0!==e?e:t.g,In(this,t.j),this.s=t.s,Cn(this,t.i),Nn(this,t.m),this.l=t.l,e=t.h;var n=new jn;n.i=e.i,e.g&&(n.g=new bn(e.g),n.h=e.h),Dn(this,n),this.o=t.o}else t&&(n=String(t).match(Sn))?(this.g=!!e,In(this,n[1]||"",!0),this.s=Rn(n[2]||""),Cn(this,n[3]||"",!0),Nn(this,n[4]),this.l=Rn(n[5]||"",!0),Dn(this,n[6]||"",!0),this.o=Rn(n[7]||"")):(this.g=!!e,this.h=new jn(null,this.g))}function An(t){return new xn(t)}function In(t,e,n){t.j=n?Rn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Cn(t,e,n){t.i=n?Rn(e,!0):e}function Nn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Dn(t,e,n){e instanceof jn?(t.h=e,function(t,e){e&&!t.j&&(qn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Gn(this,e),Hn(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=On(e,Un)),t.h=new jn(e,t.g))}function _n(t,e,n){t.h.set(e,n)}function Ln(t){return _n(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function On(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Mn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Mn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}xn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(On(e,Pn,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(On(e,Pn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(On(n,"/"==n.charAt(0)?Fn:Vn,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",On(n,Bn)),t.join("")};var Pn=/[#\/\?@]/g,Vn=/[#\?:]/g,Fn=/[#\?]/g,Un=/[#\?@]/g,Bn=/#/g;function jn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function qn(t){t.g||(t.g=new bn,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var a=t[n].substring(0,r);i=t[n].substring(r+1)}else a=t[n];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Gn(t,e){qn(t),e=zn(t,e),Tn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Tn((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&En(t)))}function Kn(t,e){return qn(t),e=zn(t,e),Tn(t.g.h,e)}function Hn(t,e,n){Gn(t,e),0<n.length&&(t.i=null,t.g.set(zn(t,e),vt(n)),t.h+=n.length)}function zn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(L=jn.prototype).add=function(t,e){qn(this),this.i=null,t=zn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},L.forEach=function(t,e){qn(this),this.g.forEach((function(n,r){ft(n,(function(n){t.call(e,n,r,this)}),this)}),this)},L.T=function(){qn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],a=0;a<i.length;a++)n.push(e[r]);return n},L.R=function(t){qn(this);var e=[];if("string"==typeof t)Kn(this,t)&&(e=dt(e,this.g.get(zn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=dt(e,t[n])}return e},L.set=function(t,e){return qn(this),this.i=null,Kn(this,t=zn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},L.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},L.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),t.push(o)}}return this.i=t.join("&")};var Qn=function e(n,r){"use strict";t(O)(this,e),this.h=n,this.g=r};function Xn(t){this.l=t||Wn,Z.PerformanceNavigationTiming?t=0<(t=Z.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Z.g&&Z.g.Ea&&Z.g.Ea()&&Z.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Wn=10;function Yn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Jn(t){return t.h?1:t.g?t.g.size:0}function Zn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function $n(t,e){t.g?t.g.add(e):t.h=e}function tr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function er(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var e=t.i,n=!0,r=!1,i=void 0;try{for(var a,o=t.g.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;e=e.concat(s.D)}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}return vt(t.i)}function nr(){}function rr(){this.g=new nr}function ir(t,e,n){var r=n||"";try{wn(t,(function(t,n){var i=t;et(t)&&(i=ye(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function ar(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function or(t){this.l=t.$b||null,this.j=t.ib||!1}function sr(t,e){de.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ur,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Xn.prototype.cancel=function(){if(this.i=er(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var t=!0,e=!1,n=void 0;try{for(var r,i=this.g.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.cancel()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}this.g.clear()}},nr.prototype.stringify=function(t){return Z.JSON.stringify(t,void 0)},nr.prototype.parse=function(t){return Z.JSON.parse(t,void 0)},ut(or,We),or.prototype.g=function(){return new sr(this.l,this.j)},or.prototype.i=function(t){return function(){return t}}({}),ut(sr,de);var ur=0;function cr(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function lr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,hr(t)}function hr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(L=sr.prototype).open=function(t,e){if(this.readyState!=ur)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,hr(this)},L.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Z).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},L.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,lr(this)),this.readyState=ur},L.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,hr(this)),this.g&&(this.readyState=3,hr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Z.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;cr(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},L.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?lr(this):hr(this),3==this.readyState&&cr(this)}},L.Ua=function(t){this.g&&(this.response=this.responseText=t,lr(this))},L.Ta=function(t){this.g&&(this.response=t,lr(this))},L.ha=function(){this.g&&lr(this)},L.setRequestHeader=function(t,e){this.v.append(t,e)},L.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},L.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(sr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var fr=Z.JSON.parse;function dr(t){de.call(this),this.headers=new bn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=vr,this.K=this.L=!1}ut(dr,de);var vr="",pr=/^https?$/i,yr=["POST","PUT"];function gr(t){return"content-type"==t.toLowerCase()}function mr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,kr(t),br(t)}function kr(t){t.D||(t.D=!0,ve(t,"complete"),ve(t,"error"))}function wr(t){if(t.h&&void 0!==J&&(!t.C[1]||4!=Tr(t)||2!=t.ba()))if(t.v&&4==Tr(t))Ne(t.Fa,0,t);else if(ve(t,"readystatechange"),4==Tr(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var a=String(t.H).match(Sn)[1]||null;if(!a&&Z.self&&Z.self.location){var o=Z.self.location.protocol;a=o.substr(0,o.length-1)}i=!pr.test(a?a.toLowerCase():"")}e=i}if(e)ve(t,"complete"),ve(t,"success");else{t.m=6;try{var s=2<Tr(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.ba()+"]",kr(t)}}finally{br(t)}}}function br(t,e){if(t.g){Er(t);var n=t.g,r=t.C[0]?$:null;t.g=null,t.C=null,e||ve(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Er(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Z.clearTimeout(t.A),t.A=null)}function Tr(t){return t.g?t.g.readyState:0}function Sr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case vr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function xr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Et(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):_n(t,e,n))}function Ar(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ir(t){this.za=0,this.l=[],this.h=new Pe,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ar("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ar("baseRetryDelayMs",5e3,t),this.$a=Ar("retryDelaySeedMs",1e4,t),this.Ya=Ar("forwardChannelMaxRetries",2,t),this.ra=Ar("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Xn(t&&t.concurrentRequestLimit),this.Ca=new rr,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Cr(t){if(Dr(t),3==t.G){var e=t.V++,n=An(t.F);_n(n,"SID",t.J),_n(n,"RID",e),_n(n,"TYPE","terminate"),Or(t,n),(e=new rn(t,t.h,e,void 0)).K=2,e.v=Ln(An(n)),n=!1,Z.navigator&&Z.navigator.sendBeacon&&(n=Z.navigator.sendBeacon(e.v.toString(),"")),!n&&Z.Image&&((new Image).src=e.v,n=!0),n||(e.g=zr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),vn(e)}Kr(t)}function Nr(t){t.g&&(Fr(t),t.g.cancel(),t.g=null)}function Dr(t){Nr(t),t.u&&(Z.clearTimeout(t.u),t.u=null),Br(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Z.clearTimeout(t.m),t.m=null)}function _r(t,e){t.l.push(new Qn(t.Za++,e)),3==t.G&&Lr(t)}function Lr(t){Yn(t.i)||t.m||(t.m=!0,Te(t.Ha,t),t.C=0)}function Rr(t,e){var n;n=e?e.m:t.V++;var r=An(t.F);_n(r,"SID",t.J),_n(r,"RID",n),_n(r,"AID",t.U),Or(t,r),t.o&&t.s&&xr(r,t.o,t.s),n=new rn(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Mr(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),$n(t.i,n),cn(n,r,e)}function Or(t,e){t.j&&wn({},(function(t,n){_n(e,n,t)}))}function Mr(t,e,n){n=Math.min(t.l.length,n);var r=t.j?ot(t.j.Oa,t.j,t):null;t:for(var i=t.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{ir(l,o,"req"+c+"_")}catch(t){r&&r(l)}}if(s){r=o.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function Pr(t){t.g||t.u||(t.Y=1,Te(t.Ga,t),t.A=0)}function Vr(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=ze(ot(t.Ga,t),qr(t,t.A)),t.A++,!0)}function Fr(t){null!=t.B&&(Z.clearTimeout(t.B),t.B=null)}function Ur(t){t.g=new rn(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=An(t.oa);_n(e,"RID","rpc"),_n(e,"SID",t.J),_n(e,"CI",t.N?"0":"1"),_n(e,"AID",t.U),Or(t,e),_n(e,"TYPE","xmlhttp"),t.o&&t.s&&xr(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Ln(An(e)),n.s=null,n.U=!0,ln(n,t)}function Br(t){null!=t.v&&(Z.clearTimeout(t.v),t.v=null)}function jr(t,e){var n=null;if(t.g==e){Br(t),Fr(t),t.g=null;var r=2}else{if(!Zn(t.i,e))return;n=e.D,tr(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;ve(r=Be(),new He(r,n,e,i)),Lr(t)}else Pr(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Jn(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ze(ot(t.Ha,t,e),qr(t,t.C)),t.C++,0)))}(t,e)||2==r&&Vr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Gr(t,5);break;case 4:Gr(t,10);break;case 3:Gr(t,6);break;default:Gr(t,2)}}function qr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Gr(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=ot(t.jb,t);n||(n=new xn("//www.google.com/images/cleardot.gif"),Z.location&&"http"==Z.location.protocol||In(n,"https"),Ln(n)),function(t,e){var n=new Pe;if(Z.Image){var r=new Image;r.onload=st(ar,n,r,"TestLoadImage: loaded",!0,e),r.onerror=st(ar,n,r,"TestLoadImage: error",!1,e),r.onabort=st(ar,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=st(ar,n,r,"TestLoadImage: timeout",!1,e),Z.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ke(2);t.G=0,t.j&&t.j.va(e),Kr(t),Dr(t)}function Kr(t){t.G=0,t.I=-1,t.j&&(0==er(t.i).length&&0==t.l.length||(t.i.i.length=0,vt(t.l),t.l.length=0),t.j.ua())}function Hr(t,e,n){var r=function(t){return t instanceof xn?An(t):new xn(t,void 0)}(n);if(""!=r.i)e&&Cn(r,e+"."+r.i),Nn(r,r.m);else{var i=Z.location;r=function(t,e,n,r){var i=new xn(null,void 0);return t&&In(i,t),e&&Cn(i,e),n&&Nn(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Et(t.aa,(function(t,e){_n(r,e,t)})),e=t.D,n=t.sa,e&&n&&_n(r,e,n),_n(r,"VER",t.ma),Or(t,r),r}function zr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new dr(new or({ib:!0})):new dr(t.qa)).L=t.H,e}function Qr(){}function Xr(){if(Dt&&!(10<=Number(Gt)))throw Error("Environmental error: no available transport.")}function Wr(t,e){de.call(this),this.g=new Ir(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!pt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!pt(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Zr(this)}function Yr(t){tn.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Jr(){en.call(this),this.status=1}function Zr(t){this.g=t}(L=dr.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ze.g(),this.C=this.u?Ye(this.u):Ye(Ze),this.g.onreadystatechange=ot(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void mr(this,t)}t=n||"";var i=new bn(this.headers);r&&wn(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=gr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Z.FormData&&t instanceof Z.FormData,!(0<=ht(yr,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Er(this),0<this.B&&((this.K=function(t){return Dt&&jt()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ot(this.pa,this)):this.A=Ne(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){mr(this,t)}},L.pa=function(){void 0!==J&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ve(this,"timeout"),this.abort(8))},L.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ve(this,"complete"),ve(this,"abort"),br(this))},L.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),br(this,!0)),dr.Z.M.call(this)},L.Fa=function(){this.s||(this.F||this.v||this.l?wr(this):this.cb())},L.cb=function(){wr(this)},L.ba=function(){try{return 2<Tr(this)?this.g.status:-1}catch(t){return-1}},L.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},L.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),fr(e)}},L.Da=function(){return this.m},L.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(L=Ir.prototype).ma=8,L.G=1,L.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},L.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new rn(this,this.h,t,void 0),n=this.s;if(this.P&&(n?xt(n=Tt(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Mr(this,e,r),_n(i=An(this.F),"RID",t),_n(i,"CVER",22),this.D&&_n(i,"X-HTTP-Session-Id",this.D),Or(this,i),this.o&&n&&xr(i,this.o,n),$n(this.i,e),this.Ra&&_n(i,"TYPE","init"),this.ja?(_n(i,"$req",r),_n(i,"SID","null"),e.$=!0,cn(e,i,null)):cn(e,i,r),this.G=2}}else 3==this.G&&(t?Rr(this,t):0==this.l.length||Yn(this.i)||Rr(this))},L.Ga=function(){if(this.u=null,Ur(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ze(ot(this.bb,this),t)}},L.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ke(10),Nr(this),Ur(this))},L.ab=function(){null!=this.v&&(this.v=null,Nr(this),Vr(this),Ke(19))},L.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ke(2)):(this.h.info("Failed to ping google.com"),Ke(1))},(L=Qr.prototype).xa=function(){},L.wa=function(){},L.va=function(){},L.ua=function(){},L.Oa=function(){},Xr.prototype.g=function(t,e){return new Wr(t,e)},ut(Wr,de),Wr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Te(ot(t.hb,t,e))),Ke(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Hr(t,null,t.W),Lr(t)},Wr.prototype.close=function(){Cr(this.g)},Wr.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,_r(this.g,e)}else this.v?((e={}).__data__=ye(t),_r(this.g,e)):_r(this.g,t)},Wr.prototype.M=function(){this.g.j=null,delete this.j,Cr(this.g),delete this.g,Wr.Z.M.call(this)},ut(Yr,tn),ut(Jr,en),ut(Zr,Qr),Zr.prototype.xa=function(){ve(this.g,"a")},Zr.prototype.wa=function(t){ve(this.g,new Yr(t))},Zr.prototype.va=function(t){ve(this.g,new Jr(t))},Zr.prototype.ua=function(){ve(this.g,"b")},Xr.prototype.createWebChannel=Xr.prototype.g,Wr.prototype.send=Wr.prototype.u,Wr.prototype.open=Wr.prototype.m,Wr.prototype.close=Wr.prototype.close,Qe.NO_ERROR=0,Qe.TIMEOUT=8,Qe.HTTP_ERROR=6,Xe.COMPLETE="complete",Je.EventType=$e,$e.OPEN="a",$e.CLOSE="b",$e.ERROR="c",$e.MESSAGE="d",de.prototype.listen=de.prototype.N,dr.prototype.listenOnce=dr.prototype.O,dr.prototype.getLastError=dr.prototype.La,dr.prototype.getLastErrorCode=dr.prototype.Da,dr.prototype.getStatus=dr.prototype.ba,dr.prototype.getResponseJson=dr.prototype.Qa,dr.prototype.getResponseText=dr.prototype.ga,dr.prototype.send=dr.prototype.ea;var $r=Y.createWebChannelTransport=function(){return new Xr},ti=Y.getStatEventTarget=function(){return Be()},ei=Y.ErrorCode=Qe,ni=Y.EventType=Xe,ri=Y.Event=Fe,ii=Y.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ai=Y.FetchXmlHttpFactory=or,oi=Y.WebChannel=Je,si=Y.XhrIo=dr,ui=(i("6qd2L"),"@firebase/firestore"),ci=function(){"use strict";function e(n){t(O)(this,e),this.uid=n}return t(P)(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(t){return t.uid===this.uid}}]),e}();ci.UNAUTHENTICATED=new ci(null),ci.GOOGLE_CREDENTIALS=new ci("google-credentials-uid"),ci.FIRST_PARTY=new ci("first-party-uid"),ci.MOCK_USER=new ci("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var li="9.8.3",hi=new(0,Q.Logger)("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(){return hi.logLevel}function di(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(hi.logLevel<=Q.LogLevel.DEBUG){var a,o=r.map(yi);(a=hi).debug.apply(a,["Firestore (".concat(li,"): ").concat(e)].concat(t(q)(o)))}}function vi(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(hi.logLevel<=Q.LogLevel.ERROR){var a,o=r.map(yi);(a=hi).error.apply(a,["Firestore (".concat(li,"): ").concat(e)].concat(t(q)(o)))}}function pi(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(hi.logLevel<=Q.LogLevel.WARN){var a,o=r.map(yi);(a=hi).warn.apply(a,["Firestore (".concat(li,"): ").concat(e)].concat(t(q)(o)))}}function yi(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",e="FIRESTORE (".concat(li,") INTERNAL ASSERTION FAILED: ")+t;throw vi(e),new Error(e)}function mi(t,e){t||gi()}function ki(t,e){return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},bi=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this,e,i)).code=e,a.message=i,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},t(B)(a)}return r}(X.FirebaseError),Ei=function e(){"use strict";var n=this;t(O)(this,e),this.promise=new Promise((function(t,e){n.resolve=t,n.reject=e}))},Ti=function e(n,r){"use strict";t(O)(this,e),this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(n))},Si=function(){"use strict";function e(){t(O)(this,e)}return t(P)(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(ci.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),xi=function(){"use strict";function e(n){t(O)(this,e),this.t=n,this.currentUser=ci.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return t(P)(e,[{key:"start",value:function(e,n){var r=this,i=this.i,s=function(t){return r.i!==i?(i=r.i,n(t)):Promise.resolve()},u=new Ei;this.o=function(){var t=r;r.i++,r.currentUser=r.u(),u.resolve(),u=new Ei,e.enqueueRetryable((function(){return s(t.currentUser)}))};var c=function(){var n=u,i=r;e.enqueueRetryable(t(a)(t(o).mark((function e(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.promise;case 2:return t.next=4,s(i.currentUser);case 4:case"end":return t.stop()}}),e)}))))},l=function(t){di("FirebaseAuthCredentialsProvider","Auth detected"),r.auth=t,r.auth.addAuthTokenListener(r.o),c()};this.t.onInit((function(t){return l(t)})),setTimeout((function(){if(!r.auth){var t=r.t.getImmediate({optional:!0});t?l(t):(di("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new Ei)}}),0),c()}},{key:"getToken",value:function(){var t=this,e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.i!==e?(di("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(mi("string"==typeof n.accessToken),new Ti(n.accessToken,t.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var t=this.auth&&this.auth.getUid();return mi(null===t||"string"==typeof t),new ci(t)}}]),e}(),Ai=function e(n,r,i){"use strict";t(O)(this,e),this.type="FirstParty",this.user=ci.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",r);var a=n.auth.getAuthHeaderValueForFirstParty([]);a&&this.headers.set("Authorization",a),i&&this.headers.set("X-Goog-Iam-Authorization-Token",i)},Ii=function(){"use strict";function e(n,r,i){t(O)(this,e),this.h=n,this.l=r,this.m=i}return t(P)(e,[{key:"getToken",value:function(){return Promise.resolve(new Ai(this.h,this.l,this.m))}},{key:"start",value:function(t,e){t.enqueueRetryable((function(){return e(ci.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Ci=function e(n){"use strict";t(O)(this,e),this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)},Ni=function(){"use strict";function e(n){t(O)(this,e),this.g=n,this.forceRefresh=!1,this.appCheck=null,this.p=null}return t(P)(e,[{key:"start",value:function(t,e){var n=this;this.o=function(r){t.enqueueRetryable((function(){return function(t){null!=t.error&&di("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));var r=t.token!==n.p;return n.p=t.token,di("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?e(t.token):Promise.resolve()}(r)}))};var r=function(t){di("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=t,n.appCheck.addTokenListener(n.o)};this.g.onInit((function(t){return r(t)})),setTimeout((function(){if(!n.appCheck){var t=n.g.getImmediate({optional:!0});t?r(t):di("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var t=this,e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((function(e){return e?(mi("string"==typeof e.token),t.p=e.token,new Ci(e.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Di(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _i=function(){"use strict";function e(){t(O)(this,e)}return t(P)(e,null,[{key:"I",value:function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Di(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n}}]),e}();function Li(t,e){return t<e?-1:t>e?1:0}function Ri(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Oi=function(){"use strict";function e(n,r){if(t(O)(this,e),this.seconds=n,this.nanoseconds=r,r<0)throw new bi(wi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new bi(wi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(n<-62135596800)throw new bi(wi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new bi(wi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}return t(P)(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(t){return this.seconds===t.seconds?Li(this.nanoseconds,t.nanoseconds):Li(this.seconds,t.seconds)}},{key:"isEqual",value:function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Mi=function(){"use strict";function e(n){t(O)(this,e),this.timestamp=n}return t(P)(e,[{key:"compareTo",value:function(t){return this.timestamp._compareTo(t.timestamp)}},{key:"isEqual",value:function(t){return this.timestamp.isEqual(t.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Oi(0,0))}},{key:"max",value:function(){return new e(new Oi(253402300799,999999999))}}]),e}(),Pi=function(){"use strict";function e(n,r,i){t(O)(this,e),void 0===r?r=0:r>n.length&&gi(),void 0===i?i=n.length-r:i>n.length-r&&gi(),this.segments=n,this.offset=r,this.len=i}return t(P)(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(t){n.push(t)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(t){return this.segments[this.offset+t]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"isImmediateParentOf",value:function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}},{key:"forEach",value:function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),a=e.get(r);if(i<a)return-1;if(i>a)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}]),e}(),Vi=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(){return t(O)(this,r),n.apply(this,arguments)}return t(P)(r,[{key:"construct",value:function(t,e,n){return new r(t,e,n)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var a=[],o=!0,s=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h,f=c.value;if(f.indexOf("//")>=0)throw new bi(wi.INVALID_ARGUMENT,"Invalid segment (".concat(f,"). Paths must not contain // in them."));(h=a).push.apply(h,t(q)(f.split("/").filter((function(t){return t.length>0}))))}}catch(t){s=!0,u=t}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return new r(a)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(Pi),Fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ui=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(){return t(O)(this,r),n.apply(this,arguments)}return t(P)(r,[{key:"construct",value:function(t,e,n){return new r(t,e,n)}},{key:"canonicalString",value:function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(t){return Fi.test(t)}},{key:"keyField",value:function(){return new r(["__name__"])}},{key:"fromServerFormat",value:function(t){for(var e=[],n="",i=0,a=function(){if(0===n.length)throw new bi(wi.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new bi(wi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new bi(wi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(n+=s,i++):(a(),i++)}if(a(),o)throw new bi(wi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new r(e)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(Pi),Bi=function(){"use strict";function e(n){t(O)(this,e),this.path=n}return t(P)(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(t){return null!==t&&0===Vi.comparator(this.path,t.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Vi.fromString(t))}},{key:"fromName",value:function(t){return new e(Vi.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Vi.emptyPath())}},{key:"comparator",value:function(t,e){return Vi.comparator(t.path,e.path)}},{key:"isDocumentKey",value:function(t){return t.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Vi(t.slice()))}}]),e}(),ji=function e(n,r,i,a){"use strict";t(O)(this,e),this.indexId=n,this.collectionGroup=r,this.fields=i,this.indexState=a};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ji.UNKNOWN_ID=-1;function qi(t,e){var n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Mi.fromTimestamp(1e9===r?new Oi(n+1,0):new Oi(n,r));return new Ki(i,Bi.empty(),e)}function Gi(t){return new Ki(t.readTime,t.key,-1)}var Ki=function(){"use strict";function e(n,r,i){t(O)(this,e),this.readTime=n,this.documentKey=r,this.largestBatchId=i}return t(P)(e,null,[{key:"min",value:function(){return new e(Mi.min(),Bi.empty(),-1)}},{key:"max",value:function(){return new e(Mi.max(),Bi.empty(),-1)}}]),e}();function Hi(t,e){var n=t.readTime.compareTo(e.readTime);return 0!==n?n:0!==(n=Bi.comparator(t.documentKey,e.documentKey))?n:Li(t.largestBatchId,e.largestBatchId)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zi="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Qi=function(){"use strict";function e(){t(O)(this,e),this.onCommittedListeners=[]}return t(P)(e,[{key:"addOnCommittedListener",value:function(t){this.onCommittedListeners.push(t)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(t){return t()}))}}]),e}();function Xi(t){return Wi.apply(this,arguments)}function Wi(){return(Wi=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.code===wi.FAILED_PRECONDITION&&n.message===zi){t.next=2;break}throw n;case 2:di("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return t.stop()}}),e)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yi=function(){"use strict";function e(n){var r=this;t(O)(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n((function(t){r.isDone=!0,r.result=t,r.nextCallback&&r.nextCallback(t)}),(function(t){r.isDone=!0,r.error=t,r.catchCallback&&r.catchCallback(t)}))}return t(P)(e,[{key:"catch",value:function(t){return this.next(void 0,t)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&gi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){var a=r;r.nextCallback=function(n){a.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){a.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(t){return n(t)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n=e.resolve(!1),r=!0,i=!1,a=void 0;try{for(var o,s=function(t,r){var i=r.value;n=n.next((function(t){return t?e.resolve(t):i()}))},u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}},{key:"forEach",value:function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var i=function(i){var u=i;n(t[u]).next((function(t){o[u]=t,++s===a&&e(o)}),(function(t){return r(t)}))},a=t.length,o=new Array(a),s=0,u=0;u<a;u++)i(u)}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){var i=function(){!0===t()?n().next((function(){i()}),r):e()};i()}))}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t){return"IndexedDbTransactionError"===t.name}var Zi=function(){"use strict";function e(n,r){var i=this;t(O)(this,e),this.previousValue=n,r&&(r.sequenceNumberHandler=function(t){return i.it(t)},this.rt=function(t){return r.writeSequenceNumber(t)})}return t(P)(e,[{key:"it",value:function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}},{key:"next",value:function(){var t=++this.previousValue;return this.rt&&this.rt(t),t}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function $i(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ta(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ea(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zi.ot=-1;var na=function(){"use strict";function e(n,r){t(O)(this,e),this.comparator=n,this.root=r||ia.EMPTY}return t(P)(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,ia.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ia.BLACK,null,null))}},{key:"get",value:function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}},{key:"indexOf",value:function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(t){return this.root.inorderTraversal(t)}},{key:"forEach",value:function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))}},{key:"toString",value:function(){var t=[];return this.inorderTraversal((function(e,n){return t.push("".concat(e,":").concat(n)),!1})),"{".concat(t.join(", "),"}")}},{key:"reverseTraversal",value:function(t){return this.root.reverseTraversal(t)}},{key:"getIterator",value:function(){return new ra(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(t){return new ra(this.root,t,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new ra(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(t){return new ra(this.root,t,this.comparator,!0)}}]),e}(),ra=function(){"use strict";function e(n,r,i,a){t(O)(this,e),this.isReverse=a,this.nodeStack=[];for(var o=1;!n.isEmpty();)if(o=r?i(n.key,r):1,r&&a&&(o*=-1),o<0)n=this.isReverse?n.left:n.right;else{if(0===o){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}return t(P)(e,[{key:"getNext",value:function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}]),e}(),ia=function(){"use strict";function e(n,r,i,a,o){t(O)(this,e),this.key=n,this.value=r,this.color=null!=i?i:e.RED,this.left=null!=a?a:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return t(P)(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}},{key:"reverseTraversal",value:function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}},{key:"moveRedLeft",value:function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t}},{key:"moveRedRight",value:function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}},{key:"checkMaxDepth",value:function(){var t=this.check();return Math.pow(2,t)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw gi();if(this.right.isRed())throw gi();var t=this.left.check();if(t!==this.right.check())throw gi();return t+(this.isRed()?0:1)}}]),e}();ia.EMPTY=null,ia.RED=!0,ia.BLACK=!1,ia.EMPTY=new(function(){"use strict";function e(){t(O)(this,e),this.size=0}return t(P)(e,[{key:"key",get:function(){throw gi()}},{key:"value",get:function(){throw gi()}},{key:"color",get:function(){throw gi()}},{key:"left",get:function(){throw gi()}},{key:"right",get:function(){throw gi()}},{key:"copy",value:function(t,e,n,r,i){return this}},{key:"insert",value:function(t,e,n){return new ia(t,e)}},{key:"remove",value:function(t,e){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(t){return!1}},{key:"reverseTraversal",value:function(t){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var aa=function(){"use strict";function e(n){t(O)(this,e),this.comparator=n,this.data=new na(this.comparator)}return t(P)(e,[{key:"has",value:function(t){return null!==this.data.get(t)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(t){return this.data.indexOf(t)}},{key:"forEach",value:function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))}},{key:"forEachInRange",value:function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}},{key:"forEachWhile",value:function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}},{key:"getIterator",value:function(){return new oa(this.data.getIterator())}},{key:"getIteratorFrom",value:function(t){return new oa(this.data.getIteratorFrom(t))}},{key:"add",value:function(t){return this.copy(this.data.remove(t).insert(t,!0))}},{key:"delete",value:function(t){return this.has(t)?this.copy(this.data.remove(t)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var t=[];return this.forEach((function(e){t.push(e)})),t}},{key:"toString",value:function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),oa=function(){"use strict";function e(n){t(O)(this,e),this.iter=n}return t(P)(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var sa=function(){"use strict";function e(n){t(O)(this,e),this.fields=n,n.sort(Ui.comparator)}return t(P)(e,[{key:"unionWith",value:function(t){var n=new aa(Ui.comparator),r=!0,i=!1,a=void 0;try{for(var o,s=this.fields[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n=n.add(u)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var c=!0,l=!1,h=void 0;try{for(var f,d=t[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;n=n.add(v)}}catch(t){l=!0,h=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return new e(n.toArray())}},{key:"covers",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){if(i.value.isPrefixOf(t))return!0}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"isEqual",value:function(t){return Ri(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ua=Symbol.iterator,ca=function(){"use strict";function e(n){t(O)(this,e),this.binaryString=n}return t(P)(e,[{key:ua,value:function(){var t=this,e=0;return{next:function(){return e<t.binaryString.length?{value:t.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){var t;return t=this.binaryString,btoa(t)}},{key:"toUint8Array",value:function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(t){return Li(this.binaryString,t.binaryString)}},{key:"isEqual",value:function(t){return this.binaryString===t.binaryString}}],[{key:"fromBase64String",value:function(t){return new e(atob(t))}},{key:"fromUint8Array",value:function(t){return new e(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ca.EMPTY_BYTE_STRING=new ca("");var la=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ha(t){if(mi(!!t),"string"==typeof t){var e=0,n=la.exec(t);if(mi(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:fa(t.seconds),nanos:fa(t.nanos)}}function fa(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function da(t){return"string"==typeof t?ca.fromBase64String(t):ca.fromUint8Array(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function pa(t){var e=ha(t.mapValue.fields.__local_write_time__.timestampValue);return new Oi(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ya=function e(n,r,i,a,o,s,u,c){"use strict";t(O)(this,e),this.databaseId=n,this.appId=r,this.persistenceKey=i,this.host=a,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=u,this.useFetchStreams=c},ga=function(){"use strict";function e(n,r){t(O)(this,e),this.projectId=n,this.database=r||"(default)"}return t(P)(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ma(t){return null==t}function ka(t){return 0===t&&1/t==-1/0}function wa(t){return"number"==typeof t&&Number.isInteger(t)&&!ka(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ba={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ea(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?va(t)?4:Ra(t)?9007199254740991:10:gi()}function Ta(t,e){if(t===e)return!0;var n,r=Ea(t);if(r!==Ea(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pa(t).isEqual(pa(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ha(t.timestampValue),r=ha(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return n=e,da(t.bytesValue).isEqual(da(n.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return fa(t.geoPointValue.latitude)===fa(e.geoPointValue.latitude)&&fa(t.geoPointValue.longitude)===fa(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return fa(t.integerValue)===fa(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=fa(t.doubleValue),r=fa(e.doubleValue);return n===r?ka(n)===ka(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ri(t.arrayValue.values||[],e.arrayValue.values||[],Ta);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if($i(n)!==$i(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ta(n[i],r[i])))return!1;return!0}(t,e);default:return gi()}}function Sa(t,e){return void 0!==(t.values||[]).find((function(t){return Ta(t,e)}))}function xa(t,e){if(t===e)return 0;var n,r,i,a,o=Ea(t),s=Ea(e);if(o!==s)return Li(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return Li(t.booleanValue,e.booleanValue);case 2:return r=e,i=fa((n=t).integerValue||n.doubleValue),a=fa(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return Aa(t.timestampValue,e.timestampValue);case 4:return Aa(pa(t),pa(e));case 5:return Li(t.stringValue,e.stringValue);case 6:return function(t,e){var n=da(t),r=da(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Li(n[i],r[i]);if(0!==a)return a}return Li(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Li(fa(t.latitude),fa(e.latitude));return 0!==n?n:Li(fa(t.longitude),fa(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var a=xa(n[i],r[i]);if(a)return a}return Li(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===ba.mapValue&&e===ba.mapValue)return 0;if(t===ba.mapValue)return 1;if(e===ba.mapValue)return-1;var n=t.fields||{},r=Object.keys(n),i=e.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=Li(r[o],a[o]);if(0!==s)return s;var u=xa(n[r[o]],i[a[o]]);if(0!==u)return u}return Li(r.length,a.length)}(t.mapValue,e.mapValue);default:throw gi()}}function Aa(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Li(t,e);var n=ha(t),r=ha(e),i=Li(n.seconds,r.seconds);return 0!==i?i:Li(n.nanos,r.nanos)}function Ia(t){return Ca(t)}function Ca(t){var e,n,r,i;return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(r=t.timestampValue,i=ha(r),"time(".concat(i.seconds,",").concat(i.nanos,")")):"stringValue"in t?t.stringValue:"bytesValue"in t?da(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Bi.fromName(n).toString()):"geoPointValue"in t?"geo(".concat((e=t.geoPointValue).latitude,",").concat(e.longitude,")"):"arrayValue"in t?function(t){var e="[",n=!0,r=!0,i=!1,a=void 0;try{for(var o,s=(t.values||[])[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n?n=!1:e+=",",e+=Ca(u)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return e+"]"}(t.arrayValue):"mapValue"in t?function(t){var e=Object.keys(t.fields||{}).sort(),n="{",r=!0,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r?r=!1:n+=",",n+="".concat(c,":").concat(Ca(t.fields[c]))}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return n+"}"}(t.mapValue):gi()}function Na(t){return!!t&&"integerValue"in t}function Da(t){return!!t&&"arrayValue"in t}function _a(t){return!!t&&"mapValue"in t}function La(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return ta(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=La(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=La(t.arrayValue.values[r]);return n}return Object.assign({},t)}function Ra(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Oa=function(){"use strict";function e(n){t(O)(this,e),this.value=n}return t(P)(e,[{key:"field",value:function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!_a(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null}},{key:"set",value:function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=La(e)}},{key:"setAll",value:function(t){var e=this,n=Ui.emptyPath(),r={},i=[];t.forEach((function(t,a){if(!n.isImmediateParentOf(a)){var o=e.getFieldsMap(n);e.applyChanges(o,r,i),r={},i=[],n=a.popLast()}t?r[a.lastSegment()]=La(t):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(t){var e=this.field(t.popLast());_a(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}},{key:"isEqual",value:function(t){return Ta(this.value,t.value)}},{key:"getFieldsMap",value:function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];_a(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}},{key:"applyChanges",value:function(t,e,n){ta(e,(function(e,n){return t[e]=n}));var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;delete t[u]}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"clone",value:function(){return new e(La(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function Ma(t){var e=[];return ta(t.fields,(function(t,n){var r=new Ui([t]);if(_a(n)){var i=Ma(n.mapValue).fields,a=!0,o=!1,s=void 0;if(0===i.length)e.push(r);else try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;e.push(r.child(l))}}catch(t){o=!0,s=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}}else e.push(r)})),new sa(e)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Pa=function(){"use strict";function e(n,r,i,a,o,s){t(O)(this,e),this.key=n,this.documentType=r,this.version=i,this.readTime=a,this.data=o,this.documentState=s}return t(P)(e,[{key:"convertToFoundDocument",value:function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}},{key:"convertToNoDocument",value:function(t){return this.version=t,this.documentType=2,this.data=Oa.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(t){return this.version=t,this.documentType=3,this.data=Oa.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Mi.min(),this}},{key:"setReadTime",value:function(t){return this.readTime=t,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Mi.min(),Mi.min(),Oa.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Mi.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Mi.min(),Oa.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Mi.min(),Oa.empty(),2)}}]),e}(),Va=function e(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;t(O)(this,e),this.path=n,this.collectionGroup=r,this.orderBy=i,this.filters=a,this.limit=o,this.startAt=s,this.endAt=u,this.ut=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new Va(t,e,n,r,i,a,o)}function Ua(t){var e=ki(t);if(null===e.ut){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){var e;return(e=t).field.canonicalString()+e.op.toString()+Ia(e.value)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.canonicalString()+e.dir;var e})).join(","),ma(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((function(t){return Ia(t)})).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((function(t){return Ia(t)})).join(",")),e.ut=n}return e.ut}function Ba(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Za(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],a=e.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!Ta(i.value,a.value))return!1;var i,a;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!to(t.startAt,e.startAt)&&to(t.endAt,e.endAt)}var ja=function(e){"use strict";t(U)(r,(function e(){t(O)(this,e)}));var n=t(K)(r);function r(e,i,a){var o;return t(O)(this,r),(o=n.call(this)).field=e,o.op=i,o.value=a,t(B)(o)}return t(P)(r,[{key:"matches",value:function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.at(xa(e,this.value)):null!==e&&Ea(this.value)===Ea(e)&&this.at(xa(e,this.value))}},{key:"at",value:function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return gi()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.ct(t,e,n):new qa(t,e,n):"array-contains"===e?new za(t,n):"in"===e?new Qa(t,n):"not-in"===e?new Xa(t,n):"array-contains-any"===e?new Wa(t,n):new r(t,e,n)}},{key:"ct",value:function(t,e,n){return"in"===e?new Ga(t,n):new Ka(t,n)}}]),r}(),qa=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i,a){var o;return t(O)(this,r),(o=n.call(this,e,i,a)).key=Bi.fromName(a.referenceValue),t(B)(o)}return t(P)(r,[{key:"matches",value:function(t){var e=Bi.comparator(t.key,this.key);return this.at(e)}}]),r}(ja),Ga=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this,e,"in",i)).keys=Ha("in",i),t(B)(a)}return t(P)(r,[{key:"matches",value:function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))}}]),r}(ja),Ka=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this,e,"not-in",i)).keys=Ha("not-in",i),t(B)(a)}return t(P)(r,[{key:"matches",value:function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))}}]),r}(ja);function Ha(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Bi.fromName(t.referenceValue)}))}var za=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){return t(O)(this,r),n.call(this,e,"array-contains",i)}return t(P)(r,[{key:"matches",value:function(t){var e=t.data.field(this.field);return Da(e)&&Sa(e.arrayValue,this.value)}}]),r}(ja),Qa=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){return t(O)(this,r),n.call(this,e,"in",i)}return t(P)(r,[{key:"matches",value:function(t){var e=t.data.field(this.field);return null!==e&&Sa(this.value.arrayValue,e)}}]),r}(ja),Xa=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){return t(O)(this,r),n.call(this,e,"not-in",i)}return t(P)(r,[{key:"matches",value:function(t){if(Sa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Sa(this.value.arrayValue,e)}}]),r}(ja),Wa=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){return t(O)(this,r),n.call(this,e,"array-contains-any",i)}return t(P)(r,[{key:"matches",value:function(t){var e=this,n=t.data.field(this.field);return!(!Da(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Sa(e.value.arrayValue,t)}))}}]),r}(ja),Ya=function e(n,r){"use strict";t(O)(this,e),this.position=n,this.inclusive=r},Ja=function e(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";t(O)(this,e),this.field=n,this.dir=r};function Za(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function $a(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var a=e[i],o=t.position[i];if(r=a.field.isKeyField()?Bi.comparator(Bi.fromName(o.referenceValue),n.key):xa(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function to(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ta(t.position[n],e.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eo=function e(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;t(O)(this,e),this.path=n,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=a,this.limit=o,this.limitType=s,this.startAt=u,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt};function no(t,e,n,r,i,a,o,s){return new eo(t,e,n,r,i,a,o,s)}function ro(t){return new eo(t)}function io(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function ao(t){var e=!0,n=!1,r=void 0;try{for(var i,a=t.filters[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;if(o.ht())return o.field}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return null}function oo(t){return null!==t.collectionGroup}function so(t){var e=ki(t);if(null===e.lt){e.lt=[];var n=ao(e),r=io(e);if(null!==n&&null===r)n.isKeyField()||e.lt.push(new Ja(n)),e.lt.push(new Ja(Ui.keyField(),"asc"));else{var i=!1,a=!0,o=!1,s=void 0;try{for(var u,c=e.explicitOrderBy[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;e.lt.push(l),l.field.isKeyField()&&(i=!0)}}catch(t){o=!0,s=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}if(!i){var h=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Ja(Ui.keyField(),h))}}}return e.lt}function uo(t){var e=ki(t);if(!e.ft)if("F"===e.limitType)e.ft=Fa(e.path,e.collectionGroup,so(e),e.filters,e.limit,e.startAt,e.endAt);else{var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=so(e)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c="desc"===u.dir?"asc":"desc";n.push(new Ja(u.field,c))}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var l=e.endAt?new Ya(e.endAt.position,e.endAt.inclusive):null,h=e.startAt?new Ya(e.startAt.position,e.startAt.inclusive):null;e.ft=Fa(e.path,e.collectionGroup,n,e.filters,e.limit,l,h)}return e.ft}function co(t,e,n){return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lo(t,e){return Ba(uo(t),uo(e))&&t.limitType===e.limitType}function ho(t){return"".concat(Ua(uo(t)),"|lt:").concat(t.limitType)}function fo(t){return"Query(target=".concat((e=uo(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: [".concat(e.filters.map((function(t){var e;return"".concat((e=t).field.canonicalString()," ").concat(e.op," ").concat(Ia(e.value))})).join(", "),"]")),ma(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: [".concat(e.orderBy.map((function(t){return"".concat((e=t).field.canonicalString()," (").concat(e.dir,")");var e})).join(", "),"]")),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((function(t){return Ia(t)})).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((function(t){return Ia(t)})).join(",")),"Target(".concat(n,")")),"; limitType=").concat(t.limitType,")");var e,n}function vo(t,e){return e.isFoundDocument()&&(i=t,o=(a=e).key.path,null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Bi.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o))&&function(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=t.explicitOrderBy[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(!s.field.isKeyField()&&null===e.data.field(s.field))return!1}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(t,e)&&function(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=t.filters[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){if(!a.value.matches(e))return!1}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(t,e)&&(r=e,!((n=t).startAt&&!function(t,e,n){var r=$a(t,e,n);return t.inclusive?r<=0:r<0}(n.startAt,so(n),r)||n.endAt&&!function(t,e,n){var r=$a(t,e,n);return t.inclusive?r>=0:r>0}(n.endAt,so(n),r)));var n,r,i,a,o}function po(t){return function(e,n){var r=!1,i=!0,a=!1,o=void 0;try{for(var s,u=so(t)[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=yo(c,e,n);if(0!==l)return l;r=r||c.field.isKeyField()}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return 0}}function yo(t,e,n){var r,i,a,o,s=t.field.isKeyField()?Bi.comparator(e.key,n.key):(r=t.field,i=n,a=e.data.field(r),o=i.data.field(r),null!==a&&null!==o?xa(a,o):gi());switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return gi()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ka(e)?"-0":e}}function mo(t){return{integerValue:""+t}}function ko(t,e){return wa(e)?mo(e):go(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wo=function e(){"use strict";t(O)(this,e),this._=void 0};function bo(t,e,n){return t instanceof So?(i=e,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):t instanceof xo?Ao(t,e):t instanceof Io?Co(t,e):function(t,e){var n=To(t,e),r=Do(n)+Do(t._t);return Na(n)&&Na(t._t)?mo(r):go(t.wt,r)}(t,e);var r,i,a}function Eo(t,e,n){return t instanceof xo?Ao(t,e):t instanceof Io?Co(t,e):n}function To(t,e){var n,r;return t instanceof No?Na(n=e)||(r=n)&&"doubleValue"in r?e:{integerValue:0}:null}var So=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(){return t(O)(this,r),n.apply(this,arguments)}return r}(wo),xo=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e){var i;return t(O)(this,r),(i=n.call(this)).elements=e,t(B)(i)}return r}(wo);function Ao(t,e){var n=_o(e),r=!0,i=!1,a=void 0;try{for(var o,s=function(t,e){var r=e.value;n.some((function(t){return Ta(t,r)}))||n.push(r)},u=t.elements[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var Io=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e){var i;return t(O)(this,r),(i=n.call(this)).elements=e,t(B)(i)}return r}(wo);function Co(t,e){var n=_o(e),r=!0,i=!1,a=void 0;try{for(var o,s=function(t,e){var r=e.value;n=n.filter((function(t){return!Ta(t,r)}))},u=t.elements[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var No=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this)).wt=e,a._t=i,t(B)(a)}return r}(wo);function Do(t){return fa(t.integerValue||t.doubleValue)}function _o(t){return Da(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lo=function e(n,r){"use strict";t(O)(this,e),this.version=n,this.transformResults=r},Ro=function(){"use strict";function e(n,r){t(O)(this,e),this.updateTime=n,this.exists=r}return t(P)(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Oo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Mo=function e(){"use strict";t(O)(this,e)};function Po(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Xo(t.key,Ro.none()):new jo(t.key,t.data,Ro.none());var n=t.data,r=Oa.empty(),i=new aa(Ui.comparator),a=!0,o=!1,s=void 0;try{for(var u,c=e.fields[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(!i.has(l)){var h=n.field(l);null===h&&l.length>1&&(l=l.popLast(),h=n.field(l)),null===h?r.delete(l):r.set(l,h),i=i.add(l)}}}catch(t){o=!0,s=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return new qo(t.key,r,new sa(i.toArray()),Ro.none())}function Vo(t,e,n){var r,i,a,o,s;t instanceof jo?(i=e,a=n,o=(r=t).value.clone(),s=Ko(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):t instanceof qo?function(t,e,n){if(Oo(t.precondition,e)){var r=Ko(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Go(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Fo(t,e,n,r){return t instanceof jo?function(t,e,n,r){if(!Oo(t.precondition,e))return n;var i=t.value.clone(),a=Ho(t.fieldTransforms,r,e);return i.setAll(a),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof qo?function(t,e,n,r){if(!Oo(t.precondition,e))return n;var i=Ho(t.fieldTransforms,r,e),a=e.data;return a.setAll(Go(t)),a.setAll(i),e.convertToFoundDocument(e.version,a).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((function(t){return t.field})))}(t,e,n,r):(i=e,a=n,Oo(t.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function Uo(t,e){var n=null,r=!0,i=!1,a=void 0;try{for(var o,s=t.fieldTransforms[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c=e.data.field(u.field),l=To(u.transform,c||null);null!=l&&(null===n&&(n=Oa.empty()),n.set(u.field,l))}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n||null}function Bo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Ri(n,r,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&(n=t.transform,r=e.transform,n instanceof xo&&r instanceof xo||n instanceof Io&&r instanceof Io?Ri(n.elements,r.elements,Ta):n instanceof No&&r instanceof No?Ta(n._t,r._t):n instanceof So&&r instanceof So);var n,r}(t,e)}))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}var jo=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return t(O)(this,r),(o=n.call(this)).key=e,o.value=i,o.precondition=a,o.fieldTransforms=s,o.type=0,t(B)(o)}return t(P)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(Mo),qo=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i,a,o){var s,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return t(O)(this,r),(s=n.call(this)).key=e,s.data=i,s.fieldMask=a,s.precondition=o,s.fieldTransforms=u,s.type=1,t(B)(s)}return t(P)(r,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),r}(Mo);function Go(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Ko(t,e,n){var r=new Map;mi(t.length===n.length);for(var i=0;i<n.length;i++){var a=t[i],o=a.transform,s=e.data.field(a.field);r.set(a.field,Eo(o,s,n[i]))}return r}function Ho(t,e,n){var r=new Map,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.transform,h=n.data.field(c.field);r.set(c.field,bo(l,h,e))}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}var zo,Qo,Xo=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this)).key=e,a.precondition=i,a.type=2,a.fieldTransforms=[],t(B)(a)}return t(P)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(Mo),Wo=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i){var a;return t(O)(this,r),(a=n.call(this)).key=e,a.precondition=i,a.type=3,a.fieldTransforms=[],t(B)(a)}return t(P)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(Mo);function Yo(t){switch(t){default:return gi();case wi.CANCELLED:case wi.UNKNOWN:case wi.DEADLINE_EXCEEDED:case wi.RESOURCE_EXHAUSTED:case wi.INTERNAL:case wi.UNAVAILABLE:case wi.UNAUTHENTICATED:return!1;case wi.INVALID_ARGUMENT:case wi.NOT_FOUND:case wi.ALREADY_EXISTS:case wi.PERMISSION_DENIED:case wi.FAILED_PRECONDITION:case wi.ABORTED:case wi.OUT_OF_RANGE:case wi.UNIMPLEMENTED:case wi.DATA_LOSS:return!0}}function Jo(t){if(void 0===t)return vi("GRPC error has no .code"),wi.UNKNOWN;switch(t){case zo.OK:return wi.OK;case zo.CANCELLED:return wi.CANCELLED;case zo.UNKNOWN:return wi.UNKNOWN;case zo.DEADLINE_EXCEEDED:return wi.DEADLINE_EXCEEDED;case zo.RESOURCE_EXHAUSTED:return wi.RESOURCE_EXHAUSTED;case zo.INTERNAL:return wi.INTERNAL;case zo.UNAVAILABLE:return wi.UNAVAILABLE;case zo.UNAUTHENTICATED:return wi.UNAUTHENTICATED;case zo.INVALID_ARGUMENT:return wi.INVALID_ARGUMENT;case zo.NOT_FOUND:return wi.NOT_FOUND;case zo.ALREADY_EXISTS:return wi.ALREADY_EXISTS;case zo.PERMISSION_DENIED:return wi.PERMISSION_DENIED;case zo.FAILED_PRECONDITION:return wi.FAILED_PRECONDITION;case zo.ABORTED:return wi.ABORTED;case zo.OUT_OF_RANGE:return wi.OUT_OF_RANGE;case zo.UNIMPLEMENTED:return wi.UNIMPLEMENTED;case zo.DATA_LOSS:return wi.DATA_LOSS;default:return gi()}}(Qo=zo||(zo={}))[Qo.OK=0]="OK",Qo[Qo.CANCELLED=1]="CANCELLED",Qo[Qo.UNKNOWN=2]="UNKNOWN",Qo[Qo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qo[Qo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qo[Qo.NOT_FOUND=5]="NOT_FOUND",Qo[Qo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qo[Qo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qo[Qo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qo[Qo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qo[Qo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qo[Qo.ABORTED=10]="ABORTED",Qo[Qo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qo[Qo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qo[Qo.INTERNAL=13]="INTERNAL",Qo[Qo.UNAVAILABLE=14]="UNAVAILABLE",Qo[Qo.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Zo=function(){"use strict";function e(n,r){t(O)(this,e),this.mapKeyFn=n,this.equalsFn=r,this.inner={},this.innerSize=0}return t(P)(e,[{key:"get",value:function(e){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=t(j)(s.value,2),l=c[0],h=c[1];if(this.equalsFn(l,e))return h}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}}},{key:"has",value:function(t){return void 0!==this.get(t)}},{key:"set",value:function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e]),this.innerSize++}},{key:"delete",value:function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){ta(this.inner,(function(n,r){var i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=t(j)(s.value,2),l=c[0],h=c[1];e(l,h)}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}))}},{key:"isEmpty",value:function(){return ea(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),$o=new na(Bi.comparator);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(){return $o}var es=new na(Bi.comparator);function ns(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=es,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r=r.insert(c.key,c)}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}function rs(t){var e=es;return t.forEach((function(t,n){return e=e.insert(t,n.overlayedDocument)})),e}function is(){return os()}function as(){return os()}function os(){return new Zo((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)}))}var ss=new na(Bi.comparator),us=new aa(Bi.comparator);function cs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=us,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r=r.add(c)}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}var ls=new aa(Li);function hs(){return ls}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fs=function e(n,r){"use strict";t(O)(this,e),this.databaseId=n,this.dt=r};function ds(t,e){return t.dt?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function vs(t,e){return t.dt?e.toBase64():e.toUint8Array()}function ps(t,e){return ds(t,e.toTimestamp())}function ys(t){return mi(!!t),Mi.fromTimestamp((e=ha(t),new Oi(e.seconds,e.nanos)));var e}function gs(t,e){return(n=t,new Vi(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function ms(t){var e=Vi.fromString(t);return mi(Ns(e)),e}function ks(t,e){return gs(t.databaseId,e.path)}function ws(t){var e=ms(t);return 4===e.length?Vi.emptyPath():Es(e)}function bs(t){return new Vi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Es(t){return mi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Ts(t,e,n){return{name:ks(t,e),fields:n.value.mapValue.fields}}function Ss(t,e){var n,r,i;if(e instanceof jo)n={update:Ts(t,e.key,e.value)};else if(e instanceof Xo)n={delete:ks(t,e.key)};else if(e instanceof qo)n={update:Ts(t,e.key,e.data),updateMask:(r=e.fieldMask,i=[],r.fields.forEach((function(t){return i.push(t.canonicalString())})),{fieldPaths:i})};else{if(!(e instanceof Wo))return gi();n={verify:ks(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof So)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof xo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Io)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof No)return{fieldPath:e.field.canonicalString(),increment:n._t};throw gi()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ps(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:gi()}(t,e.precondition)),n}function xs(t){var e=ws(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){mi(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:e=e.child(a.collectionId)}var o=[];n.where&&(o=As(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return new Ja(Is((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));var u,c,l=null;n.limit&&(u=n.limit,l=ma(c="object"==typeof u?u.value:u)?null:c);var h=null;n.startAt&&(h=function(t){var e=!!t.before,n=t.values||[];return new Ya(n,e)}(n.startAt));var f=null;return n.endAt&&(f=function(t){var e=!t.before,n=t.values||[];return new Ya(n,e)}(n.endAt)),no(e,i,s,o,l,"F",h,f)}function As(t){return t?void 0!==t.unaryFilter?[Cs(t)]:void 0!==t.fieldFilter?[(e=t,ja.create(Is(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return gi()}}(e.fieldFilter.op),e.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return As(t)})).reduce((function(t,e){return t.concat(e)})):gi():[];var e}function Is(t){return Ui.fromServerFormat(t.fieldPath)}function Cs(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Is(t.unaryFilter.field);return ja.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Is(t.unaryFilter.field);return ja.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Is(t.unaryFilter.field);return ja.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Is(t.unaryFilter.field);return ja.create(i,"!=",{nullValue:"NULL_VALUE"});default:return gi()}}function Ns(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ds=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],_s=(t(q)(Ds).concat(["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]),Ls=_s;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */t(q)(Ls).concat(["indexConfiguration","indexState","indexEntries"]);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Rs=function(){"use strict";function e(n,r,i,a){t(O)(this,e),this.batchId=n,this.localWriteTime=r,this.baseMutations=i,this.mutations=a}return t(P)(e,[{key:"applyToRemoteDocument",value:function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Vo(i,t,n[r])}}},{key:"applyToLocalView",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var a,o=this.baseMutations[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.key.isEqual(t.key)&&(e=Fo(s,t,e,this.localWriteTime))}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var u=!0,c=!1,l=void 0;try{for(var h,f=this.mutations[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;d.key.isEqual(t.key)&&(e=Fo(d,t,e,this.localWriteTime))}}catch(t){c=!0,l=t}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}return e}},{key:"applyToLocalDocumentSet",value:function(t,e){var n=this,r=as();return this.mutations.forEach((function(i){var a=t.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=Po(o,s=e.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Mi.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),cs())}},{key:"isEqual",value:function(t){return this.batchId===t.batchId&&Ri(this.mutations,t.mutations,(function(t,e){return Bo(t,e)}))&&Ri(this.baseMutations,t.baseMutations,(function(t,e){return Bo(t,e)}))}}]),e}(),Os=function(){"use strict";function e(n,r,i,a){t(O)(this,e),this.batch=n,this.commitVersion=r,this.mutationResults=i,this.docVersions=a}return t(P)(e,null,[{key:"from",value:function(t,n,r){mi(t.mutations.length===r.length);for(var i=ss,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),Ms=function(){"use strict";function e(n,r){t(O)(this,e),this.largestBatchId=n,this.mutation=r}return t(P)(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(t){return null!==t&&this.mutation===t.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Ps=function e(n){"use strict";t(O)(this,e),this.ne=n};function Vs(t){var e=xs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?co(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fs=function(){"use strict";function e(){t(O)(this,e)}return t(P)(e,[{key:"re",value:function(t,e){this.oe(t,e),e.ue()}},{key:"oe",value:function(t,e){if("nullValue"in t)this.ce(e,5);else if("booleanValue"in t)this.ce(e,10),e.ae(t.booleanValue?1:0);else if("integerValue"in t)this.ce(e,15),e.ae(fa(t.integerValue));else if("doubleValue"in t){var n=fa(t.doubleValue);isNaN(n)?this.ce(e,13):(this.ce(e,15),ka(n)?e.ae(0):e.ae(n))}else if("timestampValue"in t){var r=t.timestampValue;this.ce(e,20),"string"==typeof r?e.he(r):(e.he("".concat(r.seconds||"")),e.ae(r.nanos||0))}else if("stringValue"in t)this.le(t.stringValue,e),this.fe(e);else if("bytesValue"in t)this.ce(e,30),e.de(da(t.bytesValue)),this.fe(e);else if("referenceValue"in t)this._e(t.referenceValue,e);else if("geoPointValue"in t){var i=t.geoPointValue;this.ce(e,45),e.ae(i.latitude||0),e.ae(i.longitude||0)}else"mapValue"in t?Ra(t)?this.ce(e,Number.MAX_SAFE_INTEGER):(this.we(t.mapValue,e),this.fe(e)):"arrayValue"in t?(this.me(t.arrayValue,e),this.fe(e)):gi()}},{key:"le",value:function(t,e){this.ce(e,25),this.ge(t,e)}},{key:"ge",value:function(t,e){e.he(t)}},{key:"we",value:function(t,e){var n=t.fields||{};this.ce(e,55);var r=!0,i=!1,a=void 0;try{for(var o,s=Object.keys(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;this.le(u,e),this.oe(n[u],e)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"me",value:function(t,e){var n=t.values||[];this.ce(e,50);var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;this.oe(u,e)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"_e",value:function(t,e){var n=this;this.ce(e,37),Bi.fromName(t).path.forEach((function(t){n.ce(e,60),n.ge(t,e)}))}},{key:"ce",value:function(t,e){t.ae(e)}},{key:"fe",value:function(t){t.ae(2)}}]),e}();Fs.ye=new Fs;
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Us=function(){"use strict";function e(){t(O)(this,e),this.ze=new Bs}return t(P)(e,[{key:"addToCollectionParentIndex",value:function(t,e){return this.ze.add(e),Yi.resolve()}},{key:"getCollectionParents",value:function(t,e){return Yi.resolve(this.ze.getEntries(e))}},{key:"addFieldIndex",value:function(t,e){return Yi.resolve()}},{key:"deleteFieldIndex",value:function(t,e){return Yi.resolve()}},{key:"getDocumentsMatchingTarget",value:function(t,e){return Yi.resolve(null)}},{key:"getIndexType",value:function(t,e){return Yi.resolve(0)}},{key:"getFieldIndexes",value:function(t,e){return Yi.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(t){return Yi.resolve(null)}},{key:"getMinOffset",value:function(t,e){return Yi.resolve(Ki.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(t,e){return Yi.resolve(Ki.min())}},{key:"updateCollectionGroup",value:function(t,e,n){return Yi.resolve()}},{key:"updateIndexEntries",value:function(t,e){return Yi.resolve()}}]),e}(),Bs=function(){"use strict";function e(){t(O)(this,e),this.index={}}return t(P)(e,[{key:"add",value:function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new aa(Vi.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}},{key:"has",value:function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}},{key:"getEntries",value:function(t){return(this.index[t]||new aa(Vi.comparator)).toArray()}}]),e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Uint8Array(0);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var js=function(){"use strict";function e(n,r,i){t(O)(this,e),this.cacheSizeCollectionThreshold=n,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}return t(P)(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */js.DEFAULT_COLLECTION_PERCENTILE=10,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,js.DEFAULT=new js(41943040,js.DEFAULT_COLLECTION_PERCENTILE,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),js.DISABLED=new js(-1,0,0);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qs=function(){"use strict";function e(n){t(O)(this,e),this.En=n}return t(P)(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Gs=function(){"use strict";function e(){t(O)(this,e),this.changes=new Zo((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t(P)(e,[{key:"addEntry",value:function(t){this.assertNotApplied(),this.changes.set(t.key,t)}},{key:"removeEntry",value:function(t,e){this.assertNotApplied(),this.changes.set(t,Pa.newInvalidDocument(t).setReadTime(e))}},{key:"getEntry",value:function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Yi.resolve(n):this.getFromCache(t,e)}},{key:"getEntries",value:function(t,e){return this.getAllFromCache(t,e)}},{key:"apply",value:function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}},{key:"assertNotApplied",value:function(){}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ks=function e(n,r){"use strict";t(O)(this,e),this.overlayedDocument=n,this.mutatedFields=r},Hs=function(){"use strict";function e(n,r,i,a){t(O)(this,e),this.remoteDocumentCache=n,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=a}return t(P)(e,[{key:"getDocument",value:function(t,e){var n=this,r=null;return this.documentOverlayCache.getOverlay(t,e).next((function(i){return r=i,n.getBaseDocument(t,e,r)})).next((function(t){return null!==r&&Fo(r.mutation,t,sa.empty(),Oi.now()),t}))}},{key:"getDocuments",value:function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.getLocalViewOfDocuments(t,e,cs()).next((function(){return e}))}))}},{key:"getLocalViewOfDocuments",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cs(),r=this,i=is();return this.populateOverlays(t,i,e).next((function(){return r.computeViews(t,e,i,n).next((function(t){var e=ns();return t.forEach((function(t,n){e=e.insert(t,n.overlayedDocument)})),e}))}))}},{key:"getOverlayedDocuments",value:function(t,e){var n=this,r=is();return this.populateOverlays(t,r,e).next((function(){return n.computeViews(t,e,r,cs())}))}},{key:"populateOverlays",value:function(t,e,n){var r=[];return n.forEach((function(t){e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((function(t){t.forEach((function(t,n){e.set(t,n)}))}))}},{key:"computeViews",value:function(t,e,n,r){var i=ts(),a=os(),o=os();return e.forEach((function(t,e){var o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof qo)?i=i.insert(e.key,e):void 0!==o&&(a.set(e.key,o.mutation.getFieldMask()),Fo(o.mutation,e,o.mutation.getFieldMask(),Oi.now()))})),this.recalculateAndSaveOverlays(t,i).next((function(t){return t.forEach((function(t,e){return a.set(t,e)})),e.forEach((function(t,e){var n;return o.set(t,new Ks(e,null!==(n=a.get(t))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(t,e){var n=this,r=os(),i=new na((function(t,e){return t-e})),a=cs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){var n=!0,a=!1,o=void 0;try{for(var s,u=function(t,n){var a=n.value;a.keys().forEach((function(t){var n=e.get(t);if(null!==n){var o=r.get(t)||sa.empty();o=a.applyToLocalView(n,o),r.set(t,o);var s=(i.get(a.batchId)||cs()).add(t);i=i.insert(a.batchId,s)}}))},c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)u(0,s)}catch(t){a=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}})).next((function(){for(var o=[],s=i.getReverseIterator();s.hasNext();){var u=s.getNext(),c=u.key,l=u.value,h=as();l.forEach((function(t){if(!a.has(t)){var n=Po(e.get(t),r.get(t));null!==n&&h.set(t,n),a=a.add(t)}})),o.push(n.documentOverlayCache.saveOverlays(t,c,h))}return Yi.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.recalculateAndSaveOverlays(t,e)}))}},{key:"getDocumentsMatchingQuery",value:function(t,e,n){return r=e,Bi.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):oo(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n);var r}},{key:"getNextDocuments",value:function(t,e,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((function(a){var o=i,s=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-a.size):Yi.resolve(is()),u=-1,c=a;return s.next((function(e){return Yi.forEach(e,(function(e,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(e)?Yi.resolve():o.getBaseDocument(t,e,n).next((function(t){c=c.insert(e,t)}))})).next((function(){return o.populateOverlays(t,e,a)})).next((function(){return o.computeViews(t,c,e,cs())})).next((function(t){return{batchId:u,changes:rs(t)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(t,e){return this.getDocument(t,new Bi(e)).next((function(t){var e=ns();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(t,e,n){var r=this,i=e.collectionGroup,a=ns();return this.indexManager.getCollectionParents(t,i).next((function(o){return Yi.forEach(o,(function(o){var s,u,c=(s=e,u=o.child(i),new eo(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(t,c,n).next((function(t){t.forEach((function(t,e){a=a.insert(t,e)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(t,e,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next((function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId)})).next((function(t){t.forEach((function(t,e){var n=e.getKey();null===r.get(n)&&(r=r.insert(n,Pa.newInvalidDocument(n)))}));var n=ns();return r.forEach((function(r,i){var a=t.get(r);void 0!==a&&Fo(a.mutation,i,sa.empty(),Oi.now()),vo(e,i)&&(n=n.insert(r,i))})),n}))}},{key:"getBaseDocument",value:function(t,e,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(t,e):Yi.resolve(Pa.newInvalidDocument(e))}}]),e}(),zs=function(){"use strict";function e(n){t(O)(this,e),this.wt=n,this.Jn=new Map,this.Yn=new Map}return t(P)(e,[{key:"getBundleMetadata",value:function(t,e){return Yi.resolve(this.Jn.get(e))}},{key:"saveBundleMetadata",value:function(t,e){var n;return this.Jn.set(e.id,{id:(n=e).id,version:n.version,createTime:ys(n.createTime)}),Yi.resolve()}},{key:"getNamedQuery",value:function(t,e){return Yi.resolve(this.Yn.get(e))}},{key:"saveNamedQuery",value:function(t,e){return this.Yn.set(e.name,{name:(n=e).name,query:Vs(n.bundledQuery),readTime:ys(n.readTime)}),Yi.resolve();var n}}]),e}(),Qs=function(){"use strict";function e(){t(O)(this,e),this.overlays=new na(Bi.comparator),this.Xn=new Map}return t(P)(e,[{key:"getOverlay",value:function(t,e){return Yi.resolve(this.overlays.get(e))}},{key:"getOverlays",value:function(t,e){var n=this,r=is();return Yi.forEach(e,(function(e){return n.getOverlay(t,e).next((function(t){null!==t&&r.set(e,t)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(t,e,n){var r=this;return n.forEach((function(n,i){r.ie(t,e,i)})),Yi.resolve()}},{key:"removeOverlaysForBatchId",value:function(t,e,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach((function(t){return r.overlays=r.overlays.remove(t)})),this.Xn.delete(n)),Yi.resolve()}},{key:"getOverlaysForCollection",value:function(t,e,n){for(var r=is(),i=e.length+1,a=new Bi(e.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!e.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Yi.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(t,e,n,r){for(var i=new na((function(t,e){return t-e})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===e&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=is(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=is(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(t,e){return u.set(t,e)})),!(u.size()>=r)););return Yi.resolve(u)}},{key:"ie",value:function(t,e,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Ms(e,n));var a=this.Xn.get(e);void 0===a&&(a=cs(),this.Xn.set(e,a)),this.Xn.set(e,a.add(n.key))}}]),e}(),Xs=function(){"use strict";function e(){t(O)(this,e),this.Zn=new aa(Ws.ts),this.es=new aa(Ws.ns)}return t(P)(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(t,e){var n=new Ws(t,e);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))}},{key:"removeReference",value:function(t,e){this.rs(new Ws(t,e))}},{key:"os",value:function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))}},{key:"us",value:function(t){var e=this,n=new Bi(new Vi([])),r=new Ws(n,t),i=new Ws(n,t+1),a=[];return this.es.forEachInRange([r,i],(function(t){e.rs(t),a.push(t.key)})),a}},{key:"cs",value:function(){var t=this;this.Zn.forEach((function(e){return t.rs(e)}))}},{key:"rs",value:function(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}},{key:"hs",value:function(t){var e=new Bi(new Vi([])),n=new Ws(e,t),r=new Ws(e,t+1),i=cs();return this.es.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i}},{key:"containsKey",value:function(t){var e=new Ws(t,0),n=this.Zn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}]),e}(),Ws=function(){"use strict";function e(n,r){t(O)(this,e),this.key=n,this.ls=r}return t(P)(e,null,[{key:"ts",value:function(t,e){return Bi.comparator(t.key,e.key)||Li(t.ls,e.ls)}},{key:"ns",value:function(t,e){return Li(t.ls,e.ls)||Bi.comparator(t.key,e.key)}}]),e}(),Ys=function(){"use strict";function e(n,r){t(O)(this,e),this.indexManager=n,this.referenceDelegate=r,this.mutationQueue=[],this.fs=1,this.ds=new aa(Ws.ts)}return t(P)(e,[{key:"checkEmpty",value:function(t){return Yi.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(t,e,n,r){var i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new Rs(i,e,n,r);this.mutationQueue.push(a);var o=!0,s=!1,u=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;this.ds=this.ds.add(new Ws(h.key,i)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast())}}catch(t){s=!0,u=t}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return Yi.resolve(a)}},{key:"lookupMutationBatch",value:function(t,e){return Yi.resolve(this._s(e))}},{key:"getNextMutationBatchAfterBatchId",value:function(t,e){var n=e+1,r=this.ws(n),i=r<0?0:r;return Yi.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Yi.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(t){return Yi.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(t,e){var n=this,r=new Ws(e,0),i=new Ws(e,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],(function(t){var e=n._s(t.ls);a.push(e)})),Yi.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(t,e){var n=this,r=new aa(Li);return e.forEach((function(t){var e=new Ws(t,0),i=new Ws(t,Number.POSITIVE_INFINITY);n.ds.forEachInRange([e,i],(function(t){r=r.add(t.ls)}))})),Yi.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(t,e){var n=e.path,r=n.length+1,i=n;Bi.isDocumentKey(i)||(i=i.child(""));var a=new Ws(new Bi(i),0),o=new aa(Li);return this.ds.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.ls)),!0)}),a),Yi.resolve(this.gs(o))}},{key:"gs",value:function(t){var e=this,n=[];return t.forEach((function(t){var r=e._s(t);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(t,e){var n=this;mi(0===this.ys(e.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return Yi.forEach(e.mutations,(function(i){var a=new Ws(i.key,e.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.ds=r}))}},{key:"In",value:function(t){}},{key:"containsKey",value:function(t,e){var n=new Ws(e,0),r=this.ds.firstAfterOrEqual(n);return Yi.resolve(e.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(t){return this.mutationQueue.length,Yi.resolve()}},{key:"ys",value:function(t,e){return this.ws(t)}},{key:"ws",value:function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}},{key:"_s",value:function(t){var e=this.ws(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}]),e}(),Js=function(){"use strict";function e(n){t(O)(this,e),this.ps=n,this.docs=new na(Bi.comparator),this.size=0}return t(P)(e,[{key:"setIndexManager",value:function(t){this.indexManager=t}},{key:"addEntry",value:function(t,e){var n=e.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}},{key:"removeEntry",value:function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}},{key:"getEntry",value:function(t,e){var n=this.docs.get(e);return Yi.resolve(n?n.document.mutableCopy():Pa.newInvalidDocument(e))}},{key:"getEntries",value:function(t,e){var n=this,r=ts();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.mutableCopy():Pa.newInvalidDocument(t))})),Yi.resolve(r)}},{key:"getAllFromCollection",value:function(t,e,n){for(var r=ts(),i=new Bi(e.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!e.isPrefixOf(s.path))break;s.path.length>e.length+1||Hi(Gi(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return Yi.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(t,e,n,r){gi()}},{key:"Is",value:function(t,e){return Yi.forEach(this.docs,(function(t){return e(t)}))}},{key:"newChangeBuffer",value:function(t){return new Zs(this)}},{key:"getSize",value:function(t){return Yi.resolve(this.size)}}]),e}(),Zs=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e){var i;return t(O)(this,r),(i=n.call(this)).zn=e,t(B)(i)}return t(P)(r,[{key:"applyChanges",value:function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(e.zn.addEntry(t,i)):e.zn.removeEntry(r)})),Yi.waitFor(n)}},{key:"getFromCache",value:function(t,e){return this.zn.getEntry(t,e)}},{key:"getAllFromCache",value:function(t,e){return this.zn.getEntries(t,e)}}]),r}(Gs),$s=function(){"use strict";function e(n){t(O)(this,e),this.persistence=n,this.Ts=new Zo((function(t){return Ua(t)}),Ba),this.lastRemoteSnapshotVersion=Mi.min(),this.highestTargetId=0,this.Es=0,this.As=new Xs,this.targetCount=0,this.Rs=qs.An()}return t(P)(e,[{key:"forEachTarget",value:function(t,e){return this.Ts.forEach((function(t,n){return e(n)})),Yi.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(t){return Yi.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(t){return Yi.resolve(this.Es)}},{key:"allocateTargetId",value:function(t){return this.highestTargetId=this.Rs.next(),Yi.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Es&&(this.Es=e),Yi.resolve()}},{key:"vn",value:function(t){this.Ts.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Rs=new qs(e),this.highestTargetId=e),t.sequenceNumber>this.Es&&(this.Es=t.sequenceNumber)}},{key:"addTargetData",value:function(t,e){return this.vn(e),this.targetCount+=1,Yi.resolve()}},{key:"updateTargetData",value:function(t,e){return this.vn(e),Yi.resolve()}},{key:"removeTargetData",value:function(t,e){return this.Ts.delete(e.target),this.As.us(e.targetId),this.targetCount-=1,Yi.resolve()}},{key:"removeTargets",value:function(t,e,n){var r=this,i=0,a=[];return this.Ts.forEach((function(o,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),Yi.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(t){return Yi.resolve(this.targetCount)}},{key:"getTargetData",value:function(t,e){var n=this.Ts.get(e)||null;return Yi.resolve(n)}},{key:"addMatchingKeys",value:function(t,e,n){return this.As.ss(e,n),Yi.resolve()}},{key:"removeMatchingKeys",value:function(t,e,n){this.As.os(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Yi.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(t,e){return this.As.us(e),Yi.resolve()}},{key:"getMatchingKeysForTargetId",value:function(t,e){var n=this.As.hs(e);return Yi.resolve(n)}},{key:"containsKey",value:function(t,e){return Yi.resolve(this.As.containsKey(e))}}]),e}(),tu=function(){"use strict";function e(n,r){var i=this;t(O)(this,e),this.bs={},this.overlays={},this.Ps=new Zi(0),this.vs=!1,this.vs=!0,this.referenceDelegate=n(this),this.Vs=new $s(this),this.indexManager=new Us,this.remoteDocumentCache=new Js((function(t){return i.referenceDelegate.Ss(t)})),this.wt=new Ps(r),this.Ds=new zs(this.wt)}return t(P)(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(t){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(t){var e=this.overlays[t.toKey()];return e||(e=new Qs,this.overlays[t.toKey()]=e),e}},{key:"getMutationQueue",value:function(t,e){var n=this.bs[t.toKey()];return n||(n=new Ys(e,this.referenceDelegate),this.bs[t.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(t,e,n){var r=this;di("MemoryPersistence","Starting transaction:",t);var i=new eu(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next((function(t){return r.referenceDelegate.xs(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))}},{key:"Ns",value:function(t,e){return Yi.or(Object.values(this.bs).map((function(n){return function(){return n.containsKey(t,e)}})))}}]),e}(),eu=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e){var i;return t(O)(this,r),(i=n.call(this)).currentSequenceNumber=e,t(B)(i)}return r}(Qi),nu=function(){"use strict";function e(n){t(O)(this,e),this.persistence=n,this.ks=new Xs,this.Os=null}return t(P)(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw gi()}},{key:"addReference",value:function(t,e,n){return this.ks.addReference(n,e),this.Fs.delete(n.toString()),Yi.resolve()}},{key:"removeReference",value:function(t,e,n){return this.ks.removeReference(n,e),this.Fs.add(n.toString()),Yi.resolve()}},{key:"markPotentiallyOrphaned",value:function(t,e){return this.Fs.add(e.toString()),Yi.resolve()}},{key:"removeTarget",value:function(t,e){var n=this;this.ks.us(e.targetId).forEach((function(t){return n.Fs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){var e=n;t.forEach((function(t){return e.Fs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Yi.forEach(this.Fs,(function(r){var i=Bi.fromPath(r);return e.$s(t,i).next((function(t){t||n.removeEntry(i,Mi.min())}))})).next((function(){return e.Os=null,n.apply(t)}))}},{key:"updateLimboDocument",value:function(t,e){var n=this;return this.$s(t,e).next((function(t){t?n.Fs.delete(e.toString()):n.Fs.add(e.toString())}))}},{key:"Ss",value:function(t){return 0}},{key:"$s",value:function(t,e){var n=this;return Yi.or([function(){return Yi.resolve(n.ks.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Ns(t,e)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ru=function(){"use strict";function e(n,r,i,a){t(O)(this,e),this.targetId=n,this.fromCache=r,this.Pi=i,this.vi=a}return t(P)(e,null,[{key:"Vi",value:function(t,n){var r=cs(),i=cs(),a=!0,o=!1,s=void 0;try{for(var u,c=n.docChanges[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}}}catch(t){o=!0,s=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return new e(t,n.fromCache,r,i)}}]),e}(),iu=function(){"use strict";function e(){t(O)(this,e),this.Si=!1}return t(P)(e,[{key:"initialize",value:function(t,e){this.Di=t,this.indexManager=e,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(t,e,n,r){var i=this;return this.Ci(t,e).next((function(a){return a||i.xi(t,e,r,n)})).next((function(n){return n||i.Ni(t,e)}))}},{key:"Ci",value:function(t,e){return Yi.resolve(null)}},{key:"xi",value:function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||r.isEqual(Mi.min())?this.Ni(t,e):this.Di.getDocuments(t,n).next((function(a){var o=i.ki(e,a);return i.Oi(e,o,n,r)?i.Ni(t,e):(fi()<=Q.LogLevel.DEBUG&&di("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),fo(e)),i.Mi(t,o,e,qi(r,-1)))}))}},{key:"ki",value:function(t,e){var n=new aa(po(t));return e.forEach((function(e,r){vo(t,r)&&(n=n.add(r))})),n}},{key:"Oi",value:function(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;var i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(t,e){return fi()<=Q.LogLevel.DEBUG&&di("QueryEngine","Using full collection scan to execute query:",fo(e)),this.Di.getDocumentsMatchingQuery(t,e,Ki.min())}},{key:"Mi",value:function(t,e,n,r){return this.Di.getDocumentsMatchingQuery(t,n,r).next((function(t){return e.forEach((function(e){t=t.insert(e.key,e)})),t}))}}]),e}(),au=function(){"use strict";function e(n,r,i,a){t(O)(this,e),this.persistence=n,this.Fi=r,this.wt=a,this.$i=new na(Li),this.Bi=new Zo((function(t){return Ua(t)}),Ba),this.Li=new Map,this.Ui=n.getRemoteDocumentCache(),this.Vs=n.getTargetCache(),this.Ds=n.getBundleCache(),this.qi(i)}return t(P)(e,[{key:"qi",value:function(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Hs(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.$i)}))}}]),e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t,e,n,r){return new au(t,e,n,r)}function su(t,e){return uu.apply(this,arguments)}function uu(){return(uu=t(a)(t(o).mark((function e(n,r){var i;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=ki(n),t.next=3,i.persistence.runTransaction("Handle user change","readonly",(function(t){var e;return i.mutationQueue.getAllMutationBatches(t).next((function(n){return e=n,i.qi(r),i.mutationQueue.getAllMutationBatches(t)})).next((function(n){var r=[],a=[],o=cs(),s=!0,u=!1,c=void 0;try{for(var l,h=e[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;r.push(f.batchId);var d=!0,v=!1,p=void 0;try{for(var y,g=f.mutations[Symbol.iterator]();!(d=(y=g.next()).done);d=!0){var m=y.value;o=o.add(m.key)}}catch(t){v=!0,p=t}finally{try{d||null==g.return||g.return()}finally{if(v)throw p}}}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}var k=!0,w=!1,b=void 0;try{for(var E,T=n[Symbol.iterator]();!(k=(E=T.next()).done);k=!0){var S=E.value;a.push(S.batchId);var x=!0,A=!1,I=void 0;try{for(var C,N=S.mutations[Symbol.iterator]();!(x=(C=N.next()).done);x=!0){var D=C.value;o=o.add(D.key)}}catch(t){A=!0,I=t}finally{try{x||null==N.return||N.return()}finally{if(A)throw I}}}}catch(t){w=!0,b=t}finally{try{k||null==T.return||T.return()}finally{if(w)throw b}}return i.localDocuments.getDocuments(t,o).next((function(t){return{Ki:t,removedBatchIds:r,addedBatchIds:a}}))}))}));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function cu(t,e){var n=ki(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,a,o,s,u,c,l=e.batch.keys(),h=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=t,a=e,o=h,s=a.batch,u=s.keys(),c=Yi.resolve(),u.forEach((function(t){c=c.next((function(){return o.getEntry(i,t)})).next((function(e){var n=a.docVersions.get(t);mi(null!==n),e.version.compareTo(n)<0&&(s.applyToRemoteDocument(e,a),e.isValidDocument()&&(e.setReadTime(a.commitVersion),o.addEntry(e)))}))})),c.next((function(){return r.mutationQueue.removeMutationBatch(i,s)}))).next((function(){return h.apply(t)})).next((function(){return n.mutationQueue.performConsistencyCheck(t)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(t,l,e.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){for(var e=cs(),n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e))})).next((function(){return n.localDocuments.getDocuments(t,l)}))}))}function lu(t){var e=ki(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Vs.getLastRemoteSnapshotVersion(t)}))}function hu(t,e){var n=ki(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e)}))}var fu=function(){"use strict";function e(){t(O)(this,e),this.activeTargetIds=hs()}return t(P)(e,[{key:"Xi",value:function(t){this.activeTargetIds=this.activeTargetIds.add(t)}},{key:"Zi",value:function(t){this.activeTargetIds=this.activeTargetIds.delete(t)}},{key:"Yi",value:function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}]),e}(),du=function(){"use strict";function e(){t(O)(this,e),this.Fr=new fu,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t(P)(e,[{key:"addPendingMutation",value:function(t){}},{key:"updateMutationState",value:function(t,e,n){}},{key:"addLocalQueryTarget",value:function(t){return this.Fr.Xi(t),this.$r[t]||"not-current"}},{key:"updateQueryState",value:function(t,e,n){this.$r[t]=e}},{key:"removeLocalQueryTarget",value:function(t){this.Fr.Zi(t)}},{key:"isLocalQueryTarget",value:function(t){return this.Fr.activeTargetIds.has(t)}},{key:"clearQueryState",value:function(t){delete this.$r[t]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(t){return this.Fr.activeTargetIds.has(t)}},{key:"start",value:function(){return this.Fr=new fu,Promise.resolve()}},{key:"handleUserChange",value:function(t,e,n){}},{key:"setOnlineState",value:function(t){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(t){}},{key:"notifyBundleLoaded",value:function(t){}}]),e}(),vu=function(){"use strict";function e(){t(O)(this,e)}return t(P)(e,[{key:"Br",value:function(t){}},{key:"shutdown",value:function(){}}]),e}(),pu=function(){"use strict";function e(){var n=this;t(O)(this,e),this.Lr=function(){return n.Ur()},this.qr=function(){return n.Kr()},this.Gr=[],this.Qr()}return t(P)(e,[{key:"Br",value:function(t){this.Gr.push(t)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){di("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var t=!0,e=!1,n=void 0;try{for(var r,i=this.Gr[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){(0,r.value)(0)}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"Kr",value:function(){di("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var t=!0,e=!1,n=void 0;try{for(var r,i=this.Gr[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){(0,r.value)(1)}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),yu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},gu=function(){"use strict";function e(n){t(O)(this,e),this.jr=n.jr,this.Wr=n.Wr}return t(P)(e,[{key:"zr",value:function(t){this.Hr=t}},{key:"Jr",value:function(t){this.Yr=t}},{key:"onMessage",value:function(t){this.Xr=t}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(t){this.jr(t)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(t){this.Yr(t)}},{key:"no",value:function(t){this.Xr(t)}}]),e}(),mu=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e){var i;return t(O)(this,r),(i=n.call(this,e)).forceLongPolling=e.forceLongPolling,i.autoDetectLongPolling=e.autoDetectLongPolling,i.useFetchStreams=e.useFetchStreams,t(B)(i)}return t(P)(r,[{key:"co",value:function(t,e,n,r){return new Promise((function(i,a){var o=new si;o.listenOnce(ni.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case ei.NO_ERROR:var e=o.getResponseJson();di("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ei.TIMEOUT:di("Connection",'RPC "'+t+'" timed out'),a(new bi(wi.DEADLINE_EXCEEDED,"Request time out"));break;case ei.HTTP_ERROR:var n=o.getStatus();if(di("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(wi).indexOf(c)>=0?c:wi.UNKNOWN);a(new bi(s,r.message))}else a(new bi(wi.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new bi(wi.UNAVAILABLE,"Connection failed."));break;default:gi()}}finally{di("Connection",'RPC "'+t+'" completed.')}var u,c}));var s=JSON.stringify(r);o.send(e,"POST",s,n,15)}))}},{key:"ho",value:function(t,e,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=$r(),a=ti(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new ai({})),this.uo(o.initMessageHeaders,e,n),(0,X.isMobileCordova)()||(0,X.isReactNative)()||(0,X.isElectron)()||(0,X.isIE)()||(0,X.isUWP)()||(0,X.isBrowserExtension)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");di("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,h=new gu({jr:function(t){l?di("Connection","Not sending because WebChannel is closed:",t):(c||(di("Connection","Opening WebChannel transport."),u.open(),c=!0),di("Connection","WebChannel sending:",t),u.send(t))},Wr:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,oi.EventType.OPEN,(function(){l||di("Connection","WebChannel transport opened.")})),f(u,oi.EventType.CLOSE,(function(){l||(l=!0,di("Connection","WebChannel transport closed"),h.eo())})),f(u,oi.EventType.ERROR,(function(t){l||(l=!0,pi("Connection","WebChannel transport errored:",t),h.eo(new bi(wi.UNAVAILABLE,"The operation could not be completed")))})),f(u,oi.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];mi(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){di("Connection","WebChannel received error:",i);var a=i.status,o=function(t){var e=zo[t];if(void 0!==e)return Jo(e)}(a),s=i.message;void 0===o&&(o=wi.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,h.eo(new bi(o,s)),u.close()}else di("Connection","WebChannel received:",n),h.no(n)}})),f(a,ri.STAT_EVENT,(function(t){t.stat===ii.PROXY?di("Connection","Detected buffering proxy"):t.stat===ii.NOPROXY&&di("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Zr()}),0),h}}]),r}(function(){"use strict";function e(n){t(O)(this,e),this.databaseInfo=n,this.databaseId=n.databaseId;var r=n.ssl?"https":"http";this.so=r+"://"+n.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t(P)(e,[{key:"ro",value:function(t,e,n,r,i){var a=this.oo(t,e);di("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(t,a,o,n).then((function(t){return di("RestConnection","Received: ",t),t}),(function(e){throw pi("RestConnection","".concat(t," failed with error: "),e,"url: ",a,"request:",n),e}))}},{key:"ao",value:function(t,e,n,r,i){return this.ro(t,e,n,r,i)}},{key:"uo",value:function(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+li,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((function(e,n){return t[n]=e})),n&&n.headers.forEach((function(e,n){return t[n]=e}))}},{key:"oo",value:function(t,e){var n=yu[t];return"".concat(this.so,"/v1/").concat(e,":").concat(n)}}]),e}());function ku(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(t){return new fs(t,!0)}var bu=function(){"use strict";function e(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;t(O)(this,e),this.js=n,this.timerId=r,this.lo=i,this.fo=a,this._o=o,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return t(P)(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(t){var e=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&di("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,(function(){return e.yo=Date.now(),t()})),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),Eu=function(){"use strict";function e(n,r,i,a,o,s,u,c){t(O)(this,e),this.js=n,this.Ao=i,this.Ro=a,this.bo=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new bu(n,r)}return t(P)(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return t(a)(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}}),n)})))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var t=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,(function(){return t.Oo()})))}},{key:"Mo",value:function(t){this.Fo(),this.stream.send(t)}},{key:"Oo",value:function(){var e=this;return t(a)(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}}),n)})))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,n){var r=this;return t(a)(t(o).mark((function i(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.Fo(),r.$o(),r.So.cancel(),r.Po++,4!==e?r.So.reset():n&&n.code===wi.RESOURCE_EXHAUSTED?(vi(n.toString()),vi("Using maximum backoff delay to prevent overloading the backend."),r.So.po()):n&&n.code===wi.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Bo(),r.stream.close(),r.stream=null),r.state=e,t.next=9,r.listener.Jr(n);case 9:case"end":return t.stop()}}),i)})))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var n=this.Lo(this.Po),r=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(n){var i=t(j)(n,2),a=i[0],o=i[1];e.Po===r&&e.Uo(a,o)}),(function(t){var r=e;n((function(){var e=new bi(wi.UNKNOWN,"Fetching auth token failed: "+t.message);return r.qo(e)}))}))}},{key:"Uo",value:function(t,e){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(t,e),this.stream.zr((function(){var t=n;r((function(){return t.state=2,t.Vo=t.js.enqueueAfterDelay(t.Ro,1e4,(function(){return t.Co()&&(t.state=3),Promise.resolve()})),t.listener.zr()}))})),this.stream.Jr((function(t){var e=n;r((function(){return e.qo(t)}))})),this.stream.onMessage((function(t){var e=n;r((function(){return e.onMessage(t)}))}))}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(t(a)(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),n)}))))}},{key:"qo",value:function(t){return di("PersistentStream","close with error: ".concat(t)),this.stream=null,this.close(4,t)}},{key:"Lo",value:function(t){var e=this;return function(n){var r=e;e.js.enqueueAndForget((function(){return r.Po===t?n():(di("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),Tu=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i,a,o,s,u){var c;return t(O)(this,r),(c=n.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,a,o,u)).wt=s,c.Wo=!1,t(B)(c)}return t(P)(r,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,t(V)(t(F)(r.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(t,e){return this.bo.ho("Write",t,e)}},{key:"onMessage",value:function(t){if(mi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Wo){this.So.reset();var e=(r=t.writeResults,i=t.commitTime,r&&r.length>0?(mi(void 0!==i),r.map((function(t){return n=i,(r=(e=t).updateTime?ys(e.updateTime):ys(n)).isEqual(Mi.min())&&(r=ys(n)),new Lo(r,e.transformResults||[]);var e,n,r}))):[]),n=ys(t.commitTime);return this.listener.Jo(n,e)}var r,i;return mi(!t.writeResults||0===t.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var t={};t.database=bs(this.wt),this.Mo(t)}},{key:"Ho",value:function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ss(e.wt,t)}))};this.Mo(n)}}]),r}(Eu),Su=function(e){"use strict";t(U)(r,(function e(){t(O)(this,e)}));var n=t(K)(r);function r(e,i,a,o){var s;return t(O)(this,r),(s=n.call(this)).authCredentials=e,s.appCheckCredentials=i,s.bo=a,s.wt=o,s.Zo=!1,t(B)(s)}return t(P)(r,[{key:"tu",value:function(){if(this.Zo)throw new bi(wi.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=t(j)(a,2),s=o[0],u=o[1];return i.bo.ro(e,n,r,s,u)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===wi.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),t):new bi(wi.UNKNOWN,t.toString())}))}},{key:"ao",value:function(e,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=t(j)(a,2),s=o[0],u=o[1];return i.bo.ao(e,n,r,s,u)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===wi.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),t):new bi(wi.UNKNOWN,t.toString())}))}},{key:"terminate",value:function(){this.Zo=!0}}]),r}(),xu=function(){"use strict";function e(n,r){t(O)(this,e),this.asyncQueue=n,this.onlineStateHandler=r,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return t(P)(e,[{key:"iu",value:function(){var t=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.nu=null,t.ou("Backend didn't respond within 10 seconds."),t.ru("Offline"),Promise.resolve()})))}},{key:"uu",value:function(t){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.ru("Offline")))}},{key:"set",value:function(t){this.cu(),this.eu=0,"Online"===t&&(this.su=!1),this.ru(t)}},{key:"ru",value:function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}},{key:"ou",value:function(t){var e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(vi(e),this.su=!1):di("OnlineStateTracker",e)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),Au=function e(n,r,i,s,u){"use strict";var c=this;t(O)(this,e),this.localStore=n,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=u,this.du.Br((function(e){var n=c;i.enqueueAndForget(t(a)(t(o).mark((function e(){return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=_u(n),!e.t0){e.next=5;break}return di("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=t(a)(t(o).mark((function e(n){var r;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=ki(n)).lu.add(4),t.next=4,Nu(r);case 4:return r._u.set("Unknown"),r.lu.delete(4),t.next=8,Iu(r);case 8:case"end":return t.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(n);case 5:case"end":return e.stop()}}),e)}))))})),this._u=new xu(i,s)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(t){return Cu.apply(this,arguments)}function Cu(){return(Cu=t(a)(t(o).mark((function e(n){var r,i,a,s,u,c;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!0,i=!1,a=void 0,!_u(n)){t.next=25;break}t.prev=2,s=n.fu[Symbol.iterator]();case 4:if(r=(u=s.next()).done){t.next=11;break}return c=u.value,t.next=8,c(!0);case 8:r=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),i=!0,a=t.t0;case 17:t.prev=17,t.prev=18,r||null==s.return||s.return();case 20:if(t.prev=20,!i){t.next=23;break}throw a;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),e,null,[[2,13,17,25],[18,,20,24]])})))).apply(this,arguments)}function Nu(t){return Du.apply(this,arguments)}function Du(){return(Du=t(a)(t(o).mark((function e(n){var r,i,a,s,u,c;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,i=!1,a=void 0,t.prev=1,s=n.fu[Symbol.iterator]();case 3:if(r=(u=s.next()).done){t.next=10;break}return c=u.value,t.next=7,c(!1);case 7:r=!0,t.next=3;break;case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),i=!0,a=t.t0;case 16:t.prev=16,t.prev=17,r||null==s.return||s.return();case 19:if(t.prev=19,!i){t.next=22;break}throw a;case 22:return t.finish(19);case 23:return t.finish(16);case 24:case"end":return t.stop()}}),e,null,[[1,12,16,24],[17,,19,23]])})))).apply(this,arguments)}function _u(t){return 0===ki(t).lu.size}function Lu(t,e,n){return Ru.apply(this,arguments)}function Ru(){return(Ru=t(a)(t(o).mark((function e(n,r,i){return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ji(r)){e.next=2;break}throw r;case 2:return n.lu.add(1),e.next=5,Nu(n);case 5:n._u.set("Offline"),i||(i=function(){return lu(n.localStore)}),n.asyncQueue.enqueueRetryable(t(a)(t(o).mark((function e(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return di("RemoteStore","Retrying IndexedDB access"),t.next=3,i();case 3:return n.lu.delete(1),t.next=6,Iu(n);case 6:case"end":return t.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ou(t,e){return e().catch((function(n){return Lu(t,n,e)}))}function Mu(t){return Pu.apply(this,arguments)}function Pu(){return(Pu=t(a)(t(o).mark((function e(n){var r,i,a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=ki(n),i=$u(r),a=r.au.length>0?r.au[r.au.length-1].batchId:-1;case 2:if(!Vu(r)){t.next=19;break}return t.prev=3,t.next=6,hu(r.localStore,a);case 6:if(null!==(s=t.sent)){t.next=10;break}return 0===r.au.length&&i.ko(),t.abrupt("break",19);case 10:a=s.batchId,Fu(r,s),t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(3),t.next=17,Lu(r,t.t0);case 17:t.next=2;break;case 19:Uu(r)&&Bu(r);case 20:case"end":return t.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function Vu(t){return _u(t)&&t.au.length<10}function Fu(t,e){t.au.push(e);var n=$u(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function Uu(t){return _u(t)&&!$u(t).Do()&&t.au.length>0}function Bu(t){$u(t).start()}function ju(t){return qu.apply(this,arguments)}function qu(){return(qu=t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$u(n).Xo();case 1:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function Gu(t){return Ku.apply(this,arguments)}function Ku(){return(Ku=t(a)(t(o).mark((function e(n){var r,i,a,s,u,c,l;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=$u(n),i=!0,a=!1,s=void 0,t.prev=2,u=n.au[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)l=c.value,r.Ho(l.mutations);t.next=10;break;case 6:t.prev=6,t.t0=t.catch(2),a=!0,s=t.t0;case 10:t.prev=10,t.prev=11,i||null==u.return||u.return();case 13:if(t.prev=13,!a){t.next=16;break}throw s;case 16:return t.finish(13);case 17:return t.finish(10);case 18:case"end":return t.stop()}}),e,null,[[2,6,10,18],[11,,13,17]])})))).apply(this,arguments)}function Hu(t,e,n){return zu.apply(this,arguments)}function zu(){return(zu=t(a)(t(o).mark((function e(n,r,i){var a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.au.shift(),s=Os.from(a,r,i),t.next=3,Ou(n,(function(){return n.remoteSyncer.applySuccessfulWrite(s)}));case 3:return t.next=5,Mu(n);case 5:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function Qu(t,e){return Xu.apply(this,arguments)}function Xu(){return Xu=t(a)(t(o).mark((function e(n,r){return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r&&$u(n).zo,!e.t0){e.next=4;break}return e.next=4,function(){var e=t(a)(t(o).mark((function e(n,r){var i,a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Yo(a=r.code)||a===wi.ABORTED){t.next=7;break}return i=n.au.shift(),$u(n).No(),t.next=5,Ou(n,(function(){return n.remoteSyncer.rejectFailedWrite(i.batchId,r)}));case 5:return t.next=7,Mu(n);case 7:case 8:case"end":return t.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(n,r);case 4:Uu(n)&&Bu(n);case 5:case"end":return e.stop()}}),e)}))),Xu.apply(this,arguments)}function Wu(t,e){return Yu.apply(this,arguments)}function Yu(){return(Yu=t(a)(t(o).mark((function e(n,r){var i,a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=ki(n)).asyncQueue.verifyOperationInProgress(),di("RemoteStore","RemoteStore received new credentials"),a=_u(i),i.lu.add(3),t.next=6,Nu(i);case 6:return a&&i._u.set("Unknown"),t.next=9,i.remoteSyncer.handleCredentialChange(r);case 9:return i.lu.delete(3),t.next=12,Iu(i);case 12:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function Ju(t,e){return Zu.apply(this,arguments)}function Zu(){return(Zu=t(a)(t(o).mark((function e(n,r){var i;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=ki(n),!r){t.next=7;break}return i.lu.delete(2),t.next=5,Iu(i);case 5:t.next=13;break;case 7:if(t.t0=r,t.t0){t.next=13;break}return i.lu.add(2),t.next=12,Nu(i);case 12:i._u.set("Unknown");case 13:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function $u(e){return e.gu||(e.gu=(r=e.datastore,i=e.asyncQueue,s={zr:ju.bind(null,e),Jr:Qu.bind(null,e),Yo:Gu.bind(null,e),Jo:Hu.bind(null,e)},(u=ki(r)).tu(),new Tu(i,u.bo,u.authCredentials,u.appCheckCredentials,u.wt,s)),e.fu.push((n=t(a)(t(o).mark((function n(r){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=6;break}return e.gu.No(),t.next=4,Mu(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(di("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}}),n)}))),function(t){return n.apply(this,arguments)}))),e.gu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */;var n,r,i,s,u}var tc=function(){"use strict";function e(n,r,i,a,o){t(O)(this,e),this.asyncQueue=n,this.timerId=r,this.targetTimeMs=i,this.op=a,this.removalCallback=o,this.deferred=new Ei,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t(P)(e,[{key:"start",value:function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new bi(wi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}},{key:"handleDelayElapsed",value:function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function ec(t,e){if(vi("AsyncQueue","".concat(e,": ").concat(t)),Ji(t))return new bi(wi.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nc=function e(){"use strict";t(O)(this,e),this.queries=new Zo((function(t){return ho(t)}),lo),this.onlineState="Unknown",this.Tu=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(t){t.Tu.forEach((function(t){t.next()}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ic=function(){"use strict";function e(n,r,i,a,o,s){t(O)(this,e),this.localStore=n,this.remoteStore=r,this.eventManager=i,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Zu={},this.tc=new Zo((function(t){return ho(t)}),lo),this.ec=new Map,this.nc=new Set,this.sc=new na(Bi.comparator),this.ic=new Map,this.rc=new Xs,this.oc={},this.uc=new Map,this.cc=qs.Rn(),this.onlineState="Unknown",this.ac=void 0}return t(P)(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function ac(t,e,n){return oc.apply(this,arguments)}function oc(){return(oc=t(a)(t(o).mark((function e(n,r,i){var a,s,u;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=mc(n),t.prev=1,t.next=4,function(t,e){var n,r,i=ki(t),a=Oi.now(),o=e.reduce((function(t,e){return t.add(e.key)}),cs());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(t){var s=ts(),u=cs();return i.Ui.getEntries(t,o).next((function(t){(s=t).forEach((function(t,e){e.isValidDocument()||(u=u.add(t))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(t,s)})).next((function(r){n=r;var o=[],s=!0,u=!1,c=void 0;try{for(var l,h=e[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value,d=Uo(f,n.get(f.key).overlayedDocument);null!=d&&o.push(new qo(f.key,d,Ma(d.value.mapValue),Ro.exists(!0)))}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return i.mutationQueue.addMutationBatch(t,a,o,e)})).next((function(e){r=e;var a=e.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(t,e.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:rs(n)}}))}(a.localStore,r);case 4:return s=t.sent,a.sharedClientState.addPendingMutation(s.batchId),e=a,o=s.batchId,c=i,l=void 0,(l=e.oc[e.currentUser.toKey()])||(l=new na(Li)),l=l.insert(o,c),e.oc[e.currentUser.toKey()]=l,t.next=9,vc(a,s.changes);case 9:return t.next=11,Mu(a.remoteStore);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),u=ec(t.t0,"Failed to persist write"),i.reject(u);case 17:case"end":return t.stop()}var e,o,c,l}),e,null,[[1,13]])})))).apply(this,arguments)}function sc(t,e,n){var r=ki(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach((function(t,n){var r=n.view.Eu(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=ki(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){var i=!0,a=!1,o=void 0;try{for(var s,u=n.listeners[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){s.value.Eu(e)&&(r=!0)}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}})),r&&rc(n)}(r.eventManager,e),i.length&&r.Zu.Go(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function uc(t,e){return cc.apply(this,arguments)}function cc(){return(cc=t(a)(t(o).mark((function e(n,r){var i,a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=ki(n),a=r.batch.batchId,t.prev=1,t.next=4,cu(i.localStore,r);case 4:return s=t.sent,dc(i,a,null),fc(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),t.next=10,vc(i,s);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),t.next=16,Xi(t.t0);case 16:case"end":return t.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function lc(t,e,n){return hc.apply(this,arguments)}function hc(){return(hc=t(a)(t(o).mark((function e(n,r,i){var a,s;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=ki(n),t.prev=1,t.next=4,function(t,e){var n=ki(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.mutationQueue.lookupMutationBatch(t,e).next((function(e){return mi(null!==e),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e)})).next((function(){return n.mutationQueue.performConsistencyCheck(t)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(t,r,e)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r)})).next((function(){return n.localDocuments.getDocuments(t,r)}))}))}(a.localStore,r);case 4:return s=t.sent,dc(a,r,i),fc(a,r),a.sharedClientState.updateMutationState(r,"rejected",i),t.next=10,vc(a,s);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),t.next=16,Xi(t.t0);case 16:case"end":return t.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function fc(t,e){(t.uc.get(e)||[]).forEach((function(t){t.resolve()})),t.uc.delete(e)}function dc(t,e,n){var r=ki(t),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(e);a&&(n?a.reject(n):a.resolve(),i=i.remove(e)),r.oc[r.currentUser.toKey()]=i}}function vc(t,e,n){return pc.apply(this,arguments)}function pc(){return pc=t(a)(t(o).mark((function e(n,r,i){var s,u,c,l;return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=ki(n),u=[],c=[],l=[],e.t0=s.tc.isEmpty(),e.t0){e.next=9;break}return s.tc.forEach((function(t,e){l.push(s.hc(e,r,i).then((function(t){if(t){s.isPrimaryClient&&s.sharedClientState.updateQueryState(e.targetId,t.fromCache?"not-current":"current"),u.push(t);var n=ru.Vi(e.targetId,t);c.push(n)}})))})),e.next=6,Promise.all(l);case 6:return s.Zu.Go(u),e.next=9,function(){var e=t(a)(t(o).mark((function e(n,r){var i,a,s,u,c,l,h,f,d,v,p;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=ki(n),t.prev=1,t.next=4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Yi.forEach(r,(function(e){return Yi.forEach(e.Pi,(function(n){return i.persistence.referenceDelegate.addReference(t,e.targetId,n)})).next((function(){return Yi.forEach(e.vi,(function(n){return i.persistence.referenceDelegate.removeReference(t,e.targetId,n)}))}))}))}));case 4:t.next=11;break;case 6:if(t.prev=6,t.t0=t.catch(1),Ji(t.t0)){t.next=10;break}throw t.t0;case 10:di("LocalStore","Failed to update sequence numbers: "+t.t0);case 11:for(a=!0,s=!1,u=void 0,t.prev=12,c=r[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)h=l.value,f=h.targetId,h.fromCache||(d=i.$i.get(f),v=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(v),i.$i=i.$i.insert(f,p));t.next=20;break;case 16:t.prev=16,t.t1=t.catch(12),s=!0,u=t.t1;case 20:t.prev=20,t.prev=21,a||null==c.return||c.return();case 23:if(t.prev=23,!s){t.next=26;break}throw u;case 26:return t.finish(23);case 27:return t.finish(20);case 28:case"end":return t.stop()}}),e,null,[[1,6],[12,16,20,28],[21,,23,27]])})));return function(t,n){return e.apply(this,arguments)}}()(s.localStore,c);case 9:case"end":return e.stop()}}),e)}))),pc.apply(this,arguments)}function yc(t,e){return gc.apply(this,arguments)}function gc(){return(gc=t(a)(t(o).mark((function e(n,r){var i,a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=ki(n)).currentUser.isEqual(r)){t.next=11;break}return di("SyncEngine","User change. New user:",r.toKey()),t.next=5,su(i.localStore,r);case 5:return a=t.sent,i.currentUser=r,(e=i).uc.forEach((function(t){t.forEach((function(t){t.reject(new bi(wi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.uc.clear(),i.sharedClientState.handleUserChange(r,a.removedBatchIds,a.addedBatchIds),t.next=11,vc(i,a.Ki);case 11:case"end":return t.stop()}var e}),e)})))).apply(this,arguments)}function mc(t){var e=ki(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uc.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lc.bind(null,e),e}var kc=function(){"use strict";function e(){t(O)(this,e),this.synchronizeTabs=!1}return t(P)(e,[{key:"initialize",value:function(e){var n=this;return t(a)(t(o).mark((function r(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.wt=wu(e.databaseInfo.databaseId),n.sharedClientState=n.dc(e),n.persistence=n._c(e),t.next=5,n.persistence.start();case 5:n.localStore=n.wc(e),n.gcScheduler=n.mc(e,n.localStore),n.indexBackfillerScheduler=n.gc(e,n.localStore);case 8:case"end":return t.stop()}}),r)})))()}},{key:"mc",value:function(t,e){return null}},{key:"gc",value:function(t,e){return null}},{key:"wc",value:function(t){return ou(this.persistence,new iu,t.initialUser,this.wt)}},{key:"_c",value:function(t){return new tu(nu.Ms,this.wt)}},{key:"dc",value:function(t){return new du}},{key:"terminate",value:function(){var e=this;return t(a)(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}}),n)})))()}}]),e}(),wc=function(){"use strict";function e(){t(O)(this,e)}return t(P)(e,[{key:"initialize",value:function(e,n){var r=this;return t(a)(t(o).mark((function i(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r.localStore,t.t0){t.next=12;break}return r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=function(t){return sc(r.syncEngine,t,1)},r.remoteStore.remoteSyncer.handleCredentialChange=yc.bind(null,r.syncEngine),t.next=12,Ju(r.remoteStore,r.syncEngine.isPrimaryClient);case 12:case"end":return t.stop()}}),i)})))()}},{key:"createEventManager",value:function(t){return new nc}},{key:"createDatastore",value:function(t){var e,n,r,i=wu(t.databaseInfo.databaseId),a=(e=t.databaseInfo,new mu(e));return n=t.authCredentials,r=t.appCheckCredentials,new Su(n,r,a,i)}},{key:"createRemoteStore",value:function(t){var e,n,r,i,a,o=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return sc(o.syncEngine,t,0)},a=pu.V()?new pu:new vu,new Au(e,n,r,i,a)}},{key:"createSyncEngine",value:function(t,e){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=t.initialUser,s=t.maxConcurrentLimboResolutions,u=e,c=new ic(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=t(a)(t(o).mark((function e(n){var r;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=ki(n),di("RemoteStore","RemoteStore shutting down."),r.lu.add(5),t.next=5,Nu(r);case 5:r.du.shutdown(),r._u.set("Unknown");case 7:case"end":return t.stop()}}),e)}))),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bc=function(){"use strict";function e(n,r,i,s){var u=this;t(O)(this,e);var c,l=this;this.authCredentials=n,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=s,this.user=ci.UNAUTHENTICATED,this.clientId=_i.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(i,(c=t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return di("FirestoreClient","Received user=",n.uid),t.next=3,l.authCredentialListener(n);case 3:l.user=n;case 4:case"end":return t.stop()}}),e)}))),function(t){return c.apply(this,arguments)})),this.appCheckCredentials.start(i,(function(t){return di("FirestoreClient","Received new app check token=",t),u.appCheckCredentialListener(t,u.user)}))}return t(P)(e,[{key:"getConfiguration",value:function(){var e=this;return t(a)(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}}),n)})))()}},{key:"setCredentialChangeListener",value:function(t){this.authCredentialListener=t}},{key:"setAppCheckTokenChangeListener",value:function(t){this.appCheckCredentialListener=t}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new bi(wi.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){this.asyncQueue.enterRestrictedMode();var e=new Ei,n=this;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(t(a)(t(o).mark((function r(){var i;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,t.t0=n.onlineComponents,!t.t0){t.next=5;break}return t.next=5,n.onlineComponents.terminate();case 5:if(t.t1=n.offlineComponents,!t.t1){t.next=9;break}return t.next=9,n.offlineComponents.terminate();case 9:n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),e.resolve(),t.next=18;break;case 14:t.prev=14,t.t2=t.catch(0),i=ec(t.t2,"Failed to shutdown persistence"),e.reject(i);case 18:case"end":return t.stop()}}),r,null,[[0,14]])})))),e.promise}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t,e){return Tc.apply(this,arguments)}function Tc(){return Tc=t(a)(t(o).mark((function e(n,r){var i,s;return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),di("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,n.getConfiguration();case 3:return i=e.sent,e.next=6,r.initialize(i);case 6:s=i.initialUser,n.setCredentialChangeListener(function(){var e=t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=s.isEqual(n),t.t0){t.next=5;break}return t.next=4,su(r.localStore,n);case 4:s=n;case 5:case"end":return t.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.persistence.setDatabaseDeletedListener((function(){return n.terminate()})),n.offlineComponents=r;case 8:case"end":return e.stop()}}),e)}))),Tc.apply(this,arguments)}function Sc(t,e){return xc.apply(this,arguments)}function xc(){return(xc=t(a)(t(o).mark((function e(n,r){var i,a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.asyncQueue.verifyOperationInProgress(),t.next=3,Ac(n);case 3:return i=t.sent,di("FirestoreClient","Initializing OnlineComponentProvider"),t.next=7,n.getConfiguration();case 7:return a=t.sent,t.next=10,r.initialize(i,a);case 10:n.setCredentialChangeListener((function(t){return Wu(r.remoteStore,t)})),n.setAppCheckTokenChangeListener((function(t,e){return Wu(r.remoteStore,e)})),n.onlineComponents=r;case 13:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function Ac(t){return Ic.apply(this,arguments)}function Ic(){return(Ic=t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n.offlineComponents,t.t0){t.next=5;break}return di("FirestoreClient","Using default OfflineComponentProvider"),t.next=5,Ec(n,new kc);case 5:return t.abrupt("return",(t.t0||t.sent,n.offlineComponents));case 6:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function Cc(t){return Nc.apply(this,arguments)}function Nc(){return(Nc=t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n.onlineComponents,t.t0){t.next=5;break}return di("FirestoreClient","Using default OnlineComponentProvider"),t.next=5,Sc(n,new wc);case 5:return t.abrupt("return",(t.t0||t.sent,n.onlineComponents));case 6:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function Dc(t){return Cc(t).then((function(t){return t.syncEngine}))}var _c=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t,e,n){if(!n)throw new bi(wi.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function Rc(t){if(!Bi.isDocumentKey(t))throw new bi(wi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function Oc(t){if(Bi.isDocumentKey(t))throw new bi(wi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function Mc(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=(n=t).constructor?n.constructor.name:null;return e?"a custom ".concat(e," object"):"an object"}var n;return"function"==typeof t?"a function":gi()}function Pc(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new bi(wi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Mc(t);throw new bi(wi.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Vc=function(){"use strict";function e(n){var r;if(t(O)(this,e),void 0===n.host){if(void 0!==n.ssl)throw new bi(wi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(r=n.ssl)||void 0===r||r;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new bi(wi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!n.experimentalAutoDetectLongPolling,this.useFetchStreams=!!n.useFetchStreams,function(t,e,n,r){if(!0===e&&!0===r)throw new bi(wi.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling)}return t(P)(e,[{key:"isEqual",value:function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}]),e}(),Fc=function(){"use strict";function e(n,r,i){t(O)(this,e),this._authCredentials=r,this._appCheckCredentials=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vc({}),this._settingsFrozen=!1,n instanceof ga?this._databaseId=n:(this._app=n,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new bi(wi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ga(t.options.projectId)}(n))}return t(P)(e,[{key:"app",get:function(){if(!this._app)throw new bi(wi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(t){if(this._settingsFrozen)throw new bi(wi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vc(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Si;switch(t.type){case"gapi":var e=t.client;return mi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ii(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new bi(wi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return t=this,(e=_c.get(t))&&(di("ComponentProvider","Removing Datastore"),_c.delete(t),e.terminate()),Promise.resolve();var t,e}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Uc=function(){"use strict";function e(n,r,i){t(O)(this,e),this.converter=r,this._key=i,this.type="document",this.firestore=n}return t(P)(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new jc(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),Bc=function(){"use strict";function e(n,r,i){t(O)(this,e),this.converter=r,this._query=i,this.type="query",this.firestore=n}return t(P)(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),jc=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i,a){var o;return t(O)(this,r),(o=n.call(this,e,i,ro(a)))._path=a,o.type="collection",t(B)(o)}return t(P)(r,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Uc(this.firestore,null,new Bi(t))}},{key:"withConverter",value:function(t){return new r(this.firestore,t,this._path)}}]),r}(Bc);function qc(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(e=(0,X.getModularInstance)(e),Lc("collection","path",n),e instanceof Fc){var o,s=(o=Vi).fromString.apply(o,[n].concat(t(q)(i)));return Oc(s),new jc(e,null,s)}var u;if(!(e instanceof Uc||e instanceof jc))throw new bi(wi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=e._path.child((u=Vi).fromString.apply(u,[n].concat(t(q)(i))));return Oc(c),new jc(e.firestore,null,c)}function Gc(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(e=(0,X.getModularInstance)(e),1===arguments.length&&(n=_i.I()),Lc("doc","path",n),e instanceof Fc){var o,s=(o=Vi).fromString.apply(o,[n].concat(t(q)(i)));return Rc(s),new Uc(e,null,new Bi(s))}var u;if(!(e instanceof Uc||e instanceof jc))throw new bi(wi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=e._path.child((u=Vi).fromString.apply(u,[n].concat(t(q)(i))));return Rc(c),new Uc(e.firestore,e instanceof jc?e.converter:null,new Bi(c))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Kc=function(){"use strict";function e(){var n=this;t(O)(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new bu(this,"async_queue_retry"),this.Kc=function(){var t=ku();t&&di("AsyncQueue","Visibility state changed to "+t.visibilityState),n.So.Eo()};var r=ku();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this.Kc)}return t(P)(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(t){this.enqueue(t)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(t){this.Gc(),this.Qc(t)}},{key:"enterRestrictedMode",value:function(t){if(!this.Fc){this.Fc=!0,this.Uc=t||!1;var e=ku();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(t){var e=this;if(this.Gc(),this.Fc)return new Promise((function(){}));var n=new Ei;return this.Qc((function(){return e.Fc&&e.Uc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(t){var e=this;this.enqueueAndForget((function(){return e.Mc.push(t),e.jc()}))}},{key:"jc",value:function(){var e=this;return t(a)(t(o).mark((function n(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),Ji(t.t0)){t.next=12;break}throw t.t0;case 12:di("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io((function(){return e.jc()}));case 14:case"end":return t.stop()}}),n,null,[[1,8]])})))()}},{key:"Qc",value:function(t){var e=this,n=this.Oc.then((function(){return e.Lc=!0,t().catch((function(t){var n,r;throw e.Bc=t,e.Lc=!1,vi("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),t})).then((function(t){return e.Lc=!1,t}))}));return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(t,e,n){var r=this;this.Gc(),this.qc.indexOf(t)>-1&&(e=0);var i=tc.createAndSchedule(this,t,e,n,(function(t){return r.Wc(t)}));return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&gi()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return t(a)(t(o).mark((function n(){var r;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case 1:return r=e.Oc,t.next=4,r;case 4:if(r!==e.Oc){t.next=1;break}case 5:case"end":return t.stop()}}),n)})))()}},{key:"Hc",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,a=this.$c[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){if(i.value.timerId===t)return!0}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"Jc",value:function(t){var e=this;return this.zc().then((function(){e.$c.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));var n=!0,r=!1,i=void 0;try{for(var a,o=e.$c[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.skipDelay(),"all"!==t&&s.timerId===t)break}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e.zc()}))}},{key:"Yc",value:function(t){this.qc.push(t)}},{key:"Wc",value:function(t){var e=this.$c.indexOf(t);this.$c.splice(e,1)}}]),e}();var Hc=function(e){"use strict";t(U)(r,e);var n=t(K)(r);function r(e,i,a){var o;return t(O)(this,r),(o=n.call(this,e,i,a)).type="firestore",o._queue=new Kc,o._persistenceKey="name"in e?e.name:"[DEFAULT]",t(B)(o)}return t(P)(r,[{key:"_terminate",value:function(){return this._firestoreClient||Qc(this),this._firestoreClient.terminate()}}]),r}(Fc);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t){return t._firestoreClient||Qc(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Qc(t){var e,n,r,i,a,o=t._freezeSettings(),s=(n=t._databaseId,r=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",i=t._persistenceKey,new ya(n,r,i,(a=o).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));t._firestoreClient=new bc(t._authCredentials,t._appCheckCredentials,t._queue,s)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Xc=function(){"use strict";function e(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t(O)(this,e);for(var a=0;a<r.length;++a)if(0===r[a].length)throw new bi(wi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ui(r)}return t(P)(e,[{key:"isEqual",value:function(t){return this._internalPath.isEqual(t._internalPath)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wc=function(){"use strict";function e(n){t(O)(this,e),this._byteString=n}return t(P)(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(t){return this._byteString.isEqual(t._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(ca.fromBase64String(t))}catch(t){throw new bi(wi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(ca.fromUint8Array(t))}}]),e}(),Yc=function e(n){"use strict";t(O)(this,e),this._methodName=n},Jc=function(){"use strict";function e(n,r){if(t(O)(this,e),!isFinite(n)||n<-90||n>90)throw new bi(wi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(r)||r<-180||r>180)throw new bi(wi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=n,this._long=r}return t(P)(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(t){return this._lat===t._lat&&this._long===t._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(t){return Li(this._lat,t._lat)||Li(this._long,t._long)}}]),e}(),Zc=/^__.*__$/,$c=function(){"use strict";function e(n,r,i){t(O)(this,e),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return t(P)(e,[{key:"toMutation",value:function(t,e){return null!==this.fieldMask?new qo(t,this.data,this.fieldMask,e,this.fieldTransforms):new jo(t,this.data,e,this.fieldTransforms)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gi()}}var el=function(){"use strict";function e(n,r,i,a,o,s){t(O)(this,e),this.settings=n,this.databaseId=r,this.wt=i,this.ignoreUndefinedProperties=a,void 0===o&&this.Xc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}return t(P)(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.ta({path:n,na:!1});return r.sa(t),r}},{key:"ia",value:function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(t){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(t){return fl(t,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))}},{key:"Xc",value:function(){if(this.path)for(var t=0;t<this.path.length;t++)this.sa(this.path.get(t))}},{key:"sa",value:function(t){if(0===t.length)throw this.oa("Document fields must not be empty");if(tl(this.Zc)&&Zc.test(t))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),nl=function(){"use strict";function e(n,r,i){t(O)(this,e),this.databaseId=n,this.ignoreUndefinedProperties=r,this.wt=i||wu(n)}return t(P)(e,[{key:"aa",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new el({Zc:t,methodName:e,ca:n,path:Ui.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function rl(t){var e=t._freezeSettings(),n=wu(t._databaseId);return new nl(t._databaseId,!!e.ignoreUndefinedProperties,n)}function il(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=t.aa(a.merge||a.mergeFields?2:0,e,n,i);ul("Data must be an object, but it was:",o,r);var s,u,c=ol(r,o);if(a.merge)s=new sa(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l=[],h=!0,f=!1,d=void 0;try{for(var v,p=a.mergeFields[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){var y=v.value,g=cl(e,y,n);if(!o.contains(g))throw new bi(wi.INVALID_ARGUMENT,"Field '".concat(g,"' is specified in your field mask but missing from your input data."));dl(l,g)||l.push(g)}}catch(t){f=!0,d=t}finally{try{h||null==p.return||p.return()}finally{if(f)throw d}}s=new sa(l),u=o.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=o.fieldTransforms;return new $c(new Oa(c),s,u)}function al(t,e){if(sl(t=(0,X.getModularInstance)(t)))return ul("Unsupported field value:",e,t),ol(t,e);if(t instanceof Yc)return function(t,e){if(!tl(e.Zc))throw e.oa("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.oa("".concat(t._methodName,"() is not currently supported inside arrays"));var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,e){var n=[],r=0,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=al(s.value,e.ra(r));null==c&&(c={nullValue:"NULL_VALUE"}),n.push(c),r++}}catch(t){a=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,X.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ko(e.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Oi.fromDate(t);return{timestampValue:ds(e.wt,n)}}if(t instanceof Oi){var r=new Oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ds(e.wt,r)}}if(t instanceof Jc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wc)return{bytesValue:vs(e.wt,t._byteString)};if(t instanceof Uc){var i=e.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw e.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:gs(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.oa("Unsupported field value: ".concat(Mc(t)))}(t,e)}function ol(t,e){var n={};return ea(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ta(t,(function(t,r){var i=al(r,e.ea(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function sl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Oi||t instanceof Jc||t instanceof Wc||t instanceof Uc||t instanceof Yc)}function ul(t,e,n){if(!sl(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=Mc(n);throw"an object"===r?e.oa(t+" a custom object"):e.oa(t+" "+r)}var i}function cl(t,e,n){if((e=(0,X.getModularInstance)(e))instanceof Xc)return e._internalPath;if("string"==typeof e)return hl(t,e);throw fl("Field path arguments must be of type string or ",t,!1,void 0,n)}var ll=new RegExp("[~\\*/\\[\\]]");function hl(e,n,r){if(n.search(ll)>=0)throw fl("Invalid field path (".concat(n,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,r);try{return t(M)(Xc,t(q)(n.split(".")))._internalPath}catch(t){throw fl("Invalid field path (".concat(n,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,r)}}function fl(t,e,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(e,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new bi(wi.INVALID_ARGUMENT,s+t+u)}function dl(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function vl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}function pl(t,e){var n=Pc(t.firestore,Hc),r=Gc(t),i=vl(t.converter,e);return yl(n,[il(rl(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ro.exists(!1))]).then((function(){return r}))}function yl(e,n){return r=zc(e),i=n,s=new Ei,r.asyncQueue.enqueueAndForget(t(a)(t(o).mark((function e(){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=ac,t.next=3,Dc(r);case 3:return t.t1=t.sent,t.t2=i,t.t3=s,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),e)})))),s.promise;var r,i,s}!function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=H.SDK_VERSION,li=e,(0,H._registerComponent)(new(0,z.Component)("firestore",(function(t,e){var r=e.options,i=t.getProvider("app").getImmediate(),a=new Hc(i,new xi(t.getProvider("auth-internal")),new Ni(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:n},r),a._setSettings(r),a}),"PUBLIC")),(0,H.registerVersion)(ui,"3.4.10",t),(0,H.registerVersion)(ui,"3.4.10","esm2017")}();u=i("dh4R1");var gl,ml=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,H.getApp)();return(0,H._getProvider)(t,"firestore").getImmediate()}(app),kl=(0,R.getAuth)(),wl={formWrap:document.querySelector(".form-auth"),loginForm:document.querySelector('[name="loginForm"]'),regForm:document.querySelector('[name="regForm"]'),regBtn:document.querySelector('[name="regBtn"]'),loginBtn:document.querySelector('[name="loginBtn"]'),libBtn:document.querySelector(".nav__library"),logoutBtn:document.querySelector('[name="logoutBtn"]')};function bl(){return(bl=t(a)(t(o).mark((function e(n){var r,i;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=n.target.elements.emailLogin.value.trim(),i=n.target.elements.passwordLogin.value.trim(),t.next=5,(0,R.signInWithEmailAndPassword)(kl,r,i);case 5:case"end":return t.stop()}}),e)})))).apply(this,arguments)}function El(){wl.logoutBtn.classList.remove("is-hidden"),wl.libBtn.classList.remove("is-hidden"),wl.loginBtn.classList.add("is-hidden"),wl.regBtn.classList.add("is-hidden"),wl.regForm.classList.add("is-hidden"),wl.formWrap.classList.add("is-hidden")}function Tl(){wl.loginBtn.classList.remove("is-hidden"),wl.regBtn.classList.remove("is-hidden"),wl.libBtn.classList.add("is-hidden"),wl.logoutBtn.classList.add("is-hidden")}wl.regForm.addEventListener("submit",(function(e){e.preventDefault();var n=e.target.elements.emailReg.value.trim(),r=e.target.elements.passwordReg.value.trim();(0,R.createUserWithEmailAndPassword)(kl,n,r).then((i=t(a)(t(o).mark((function e(i){var a;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("New user registered ".concat(i.user.email)),t.prev=1,t.next=4,pl(qc(ml,"users"),{email:n,password:r,films:[]});case 4:a=t.sent,console.log("Document written with ID: ",a.id),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("Error adding document: ",t.t0);case 11:case"end":return t.stop()}}),e,null,[[1,8]])}))),function(t){return i.apply(this,arguments)}));var i})),wl.loginForm.addEventListener("submit",(function(t){return bl.apply(this,arguments)})),wl.logoutBtn.addEventListener("click",(function(t){t.preventDefault(),(0,R.signOut)(kl),console.log("out")})),wl.loginBtn.addEventListener("click",(function(){wl.loginForm.classList.remove("is-hidden"),wl.formWrap.classList.remove("is-hidden"),wl.regForm.classList.add("is-hidden")})),wl.regBtn.addEventListener("click",(function(){wl.regForm.classList.remove("is-hidden"),wl.formWrap.classList.remove("is-hidden"),wl.loginForm.classList.add("is-hidden")})),(0,R.onAuthStateChanged)(kl,(gl=t(a)(t(o).mark((function e(n){return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n&&El(),n||Tl();case 2:case"end":return t.stop()}}),e)}))),function(t){return gl.apply(this,arguments)}));w=i("1vR0Z");var Sl,xl=i("eMaQ6"),Al=i("7LMqv"),Il=document.querySelector(".movie-card-list");function Cl(){return(Cl=t(a)(t(o).mark((function e(n){var r,i;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target.dataset.target){t.next=2;break}return t.abrupt("return");case 2:return r=n.target.dataset.id,t.next=5,u.default.fetchFullMovieInfo(r);case 5:if(i=t.sent,"watched"!==n.target.dataset.target){t.next=14;break}if(n.target.classList.toggle("pressed"),!n.target.classList.contains("pressed")){t.next=12;break}return n.target.textContent="Remove from Watched",(0,xl.default)(i,w.watchedArr,n.target.dataset.target),t.abrupt("return");case 12:n.target.textContent="Add to Watched",(0,Al.default)(r,w.watchedArr,n.target.dataset.target);case 14:if("queue"!==n.target.dataset.target){t.next=22;break}if(n.target.classList.toggle("pressed"),!n.target.classList.contains("pressed")){t.next=20;break}return n.target.textContent="Remove from Queue",(0,xl.default)(i,w.queueArr,n.target.dataset.target),t.abrupt("return");case 20:n.target.textContent="Add to Queue",(0,Al.default)(r,w.queueArr,n.target.dataset.target);case 22:case"end":return t.stop()}}),e)})))).apply(this,arguments)}t(l).start(),(0,w.default)(Il),u.default.fetchGenresList().then((function(t){Sl=t})),u.default.fetchTrendData().then((function(e){var n,r,i=h(c(e.results,Sl));Il.insertAdjacentHTML("beforeend",i),n=e.results,r=n.map((function(e){var n=e.poster_path,r=e.id,i=n?"".concat("https://image.tmdb.org/t/p/w500").concat(n):t(s);return'<div class="swiper-slide">\n\t\t\t\t<img src="'.concat(i,'" alt="poster" class="slide-poster" data-id="').concat(r,'"/>\n\t\t\t</div>')})).join(""),I.insertAdjacentHTML("beforeend",r);var a=document.querySelectorAll(".btn-watche"),o=document.querySelectorAll(".btn-queue");a.forEach((function(t){w.watchedArr.forEach((function(e){e.id===Number(t.dataset.id)&&(t.classList.add("pressed"),t.textContent="Remove from Watched")}))})),o.forEach((function(t){w.queueArr.forEach((function(e){e.id===Number(t.dataset.id)&&(t.classList.add("pressed"),t.textContent="Remove from Queue")}))})),g(e.total_pages,e.page)})).catch((function(t){return console.log(t)})),t(l).done(),Il.addEventListener("click",(function(t){return Cl.apply(this,arguments)}))}();
//# sourceMappingURL=index.64c3ab6f.js.map
